<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="CV professionnel de Samir Medjaher - Technicien IT & D√©veloppeur Junior avec portfolio interactif gamifi√©">
    <title>Samir Medjaher - CV Professionnel Gaming</title>
    
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Fira+Code:wght@400;500&display=swap" rel="stylesheet">
    
    <style>
        :root{--primary:#06b6d4;--secondary:#10b981;--accent:#8b5cf6;--dark:#0f172a;--dark-light:#1e293b;--dark-medium:#334155;--text-primary:#e2e8f0;--text-secondary:#94a3b8;--text-muted:#64748b;--game-gold:#fbbf24;--game-xp:#10b981}*{margin:0;padding:0;box-sizing:border-box;font-family:'Inter',sans-serif}body{background:linear-gradient(135deg,var(--dark) 0%,var(--dark-light) 50%,var(--dark-medium) 100%);color:var(--text-primary);line-height:1.5;min-height:100vh;position:relative;overflow-x:hidden}#particleCanvas{position:fixed;top:0;left:0;width:100%;height:100%;z-index:0;pointer-events:none}.glass-subtle{background:rgba(30,41,59,0.1);backdrop-filter:blur(15px);border-radius:16px;border:1px solid rgba(148,163,184,0.08);box-shadow:0 8px 32px rgba(0,0,0,0.12);position:relative;z-index:1}.glass-card{background:rgba(15,23,42,0.15);backdrop-filter:blur(12px);border-radius:12px;border:1px solid rgba(148,163,184,0.06);transition:all 0.3s ease;position:relative;z-index:1}.glass-card:hover{background:rgba(15,23,42,0.2);border-color:rgba(6,182,212,0.15);transform:translateY(-2px)}.profile-img{width:140px;height:140px;border-radius:50%;border:2px solid var(--primary);box-shadow:0 0 20px rgba(6,182,212,0.15);object-fit:cover;transition:all 0.3s ease;cursor:pointer}.profile-img:hover{transform:scale(1.03);box-shadow:0 0 30px rgba(6,182,212,0.25)}.section-title{font-size:1.25rem;font-weight:600;color:var(--primary);margin-bottom:1rem;display:flex;align-items:center;gap:0.5rem;padding-bottom:0.5rem;border-bottom:1px solid var(--dark-medium)}.contact-item{display:flex;align-items:center;gap:0.5rem;color:var(--text-secondary);padding:0.3rem;border-radius:6px;transition:all 0.3s ease;cursor:pointer}.contact-item:hover{color:var(--text-primary);background:rgba(6,182,212,0.1);transform:translateX(3px)}.contact-item i{color:var(--primary);width:16px;text-align:center;font-size:0.9rem}.skill-bubble{position:relative;background:linear-gradient(135deg,rgba(6,182,212,0.1),rgba(16,185,129,0.08));border:1px solid rgba(6,182,212,0.2);border-radius:20px;padding:0.5rem 0.8rem;text-align:center;cursor:pointer;transition:all 0.3s ease;font-size:0.8rem;margin:0.2rem;display:inline-block}.skill-bubble:hover{transform:translateY(-3px) scale(1.05);background:linear-gradient(135deg,rgba(6,182,212,0.2),rgba(16,185,129,0.15));border-color:rgba(6,182,212,0.4);box-shadow:0 8px 25px rgba(6,182,212,0.3)}.skill-tooltip{position:absolute;bottom:120%;left:50%;transform:translateX(-50%);background:rgba(15,23,42,0.95);backdrop-filter:blur(15px);border:1px solid rgba(6,182,212,0.3);border-radius:8px;padding:0.75rem;font-size:0.7rem;white-space:nowrap;opacity:0;pointer-events:none;transition:all 0.3s ease;z-index:10001;max-width:280px;white-space:normal}.skill-tooltip.show{opacity:1}.typewriter-cursor{display:inline-block;background:var(--primary);width:2px;height:1.2em;margin-left:2px;animation:blink 1s infinite}@keyframes blink{0%,50%{opacity:1}51%,100%{opacity:0}}.experience-item{position:relative;padding-left:1rem;margin-bottom:1rem}.experience-item::before{content:'';position:absolute;left:0;top:0;bottom:0;width:2px;background:linear-gradient(180deg,var(--primary),var(--secondary));border-radius:1px}.lang-switch{position:fixed;top:1.5rem;right:1.5rem;background:rgba(30,41,59,0.15);backdrop-filter:blur(15px);border-radius:20px;padding:0.3rem;display:flex;gap:0.3rem;border:1px solid rgba(148,163,184,0.1);z-index:1000}.lang-btn{background:transparent;border:none;color:var(--text-secondary);padding:0.4rem 0.8rem;border-radius:15px;cursor:pointer;font-weight:500;transition:all 0.3s ease;font-size:0.8rem}.lang-btn.active{background:rgba(6,182,212,0.2);color:var(--primary)}.color-picker-trigger{position:fixed;top:1.5rem;right:8rem;width:40px;height:40px;background:rgba(30,41,59,0.15);backdrop-filter:blur(15px);border:1px solid rgba(148,163,184,0.1);border-radius:50%;display:flex;align-items:center;justify-content:center;cursor:pointer;z-index:1000;transition:all 0.3s ease}.color-picker-trigger:hover{background:rgba(30,41,59,0.25);border-color:var(--primary);transform:scale(1.1)}.game-toggle{position:fixed;top:1.5rem;right:13rem;background:rgba(139,92,246,0.1);backdrop-filter:blur(15px);border:1px solid rgba(139,92,246,0.2);border-radius:50%;width:40px;height:40px;display:flex;align-items:center;justify-content:center;color:var(--accent);cursor:pointer;font-size:1.2rem;transition:all 0.3s ease;z-index:1000;display:none;opacity:0;transform:scale(0.8);overflow:hidden;white-space:nowrap}.game-toggle.unlocked{display:flex;animation:unlockAnimation 0.8s ease forwards}.game-toggle:hover{background:rgba(139,92,246,0.2);transform:scale(1.05);width:auto;border-radius:20px;padding:0.3rem 0.8rem;font-size:0.8rem;min-width:120px}@keyframes unlockAnimation{0%{opacity:0;transform:scale(0.8) translateY(-10px)}100%{opacity:1;transform:scale(1) translateY(0)}}.game-hud{position:fixed;bottom:10rem;right:2rem;z-index:1000;background:var(--hud-bg, rgba(15,23,42,0.9));backdrop-filter:blur(15px);border-radius:12px;padding:0.75rem 1rem;border:1px solid rgba(6,182,212,0.2);display:none;align-items:center;gap:1rem;opacity:var(--hud-opacity, 0.9);transition:all 0.3s ease;box-shadow:0 8px 25px rgba(6,182,212,0.2)}.game-hud.show{display:flex}        .game-stat{display:flex;align-items:center;gap:0.3rem;font-size:0.8rem;color:var(--text-secondary)}.game-stat i{color:var(--game-gold)}.xp-bar{width:60px;height:4px;background:rgba(148,163,184,0.2);border-radius:2px;overflow:hidden}.xp-progress{height:100%;background:linear-gradient(90deg,var(--game-xp),var(--primary));border-radius:2px;transition:width 0.5s ease;width:0%}.achievement-toast{position:fixed;bottom:12rem;right:1rem;background:linear-gradient(135deg,var(--game-gold),#f59e0b);color:white;padding:0.8rem 1rem;border-radius:12px;box-shadow:0 10px 30px rgba(251,191,36,0.3);z-index:10002;transform:translateX(100%);transition:transform 0.5s cubic-bezier(0.4,0,0.2,1);max-width:280px;border:1px solid rgba(255,255,255,0.1);font-size:0.85rem}.achievement-toast.show{transform:translateX(0)}.achievement-toast::before{content:'üèÜ';position:absolute;top:-8px;left:8px;background:var(--dark);border-radius:50%;width:20px;height:20px;display:flex;align-items:center;justify-content:center;font-size:10px;border:1px solid var(--game-gold)}.achievement-toast.show{transform:translateX(0)}.tamagotchi{position:fixed;bottom:2rem;right:2rem;width:80px;height:80px;background:rgba(15,23,42,0.9);border-radius:50%;border:2px solid var(--primary);display:none;align-items:center;justify-content:center;font-size:2rem;cursor:pointer;z-index:1000;transition:all 0.3s ease;box-shadow:0 8px 25px rgba(6,182,212,0.3)}.tamagotchi.show{display:flex;animation:gamingPulse 3s infinite}.tamagotchi:hover{transform:scale(1.1);box-shadow:0 12px 35px rgba(6,182,212,0.4)}

/* Z-index √©lev√© en mode preview */
body.hud-preview-active .tamagotchi {
    z-index:10500;
}
body.hud-preview-active .game-hud {
    z-index:10500;
}
body.hud-preview-active .achievement-toast {
    z-index:10500;
}
body.hud-preview-active .game-notification {
    z-index:10500;
}.color-picker-overlay{position:fixed;top:0;left:0;width:100vw;height:100vh;background:rgba(15,23,42,0.9);backdrop-filter:blur(20px);z-index:10000;display:flex;align-items:center;justify-content:center;opacity:0;pointer-events:none;transition:all 0.4s ease}.color-picker-overlay.active{opacity:1;pointer-events:all}

/* Mode preview: overlay en arri√®re-plan et panel repositionn√© √† gauche */
.color-picker-overlay.hud-preview-mode {
    z-index:500;
    background:rgba(15,23,42,0.7);
    justify-content:flex-start;
    padding-left:2rem;
}

.color-picker-panel{background:rgba(30,41,59,0.2);backdrop-filter:blur(25px);border:1px solid rgba(148,163,184,0.2);border-radius:24px;padding:2rem;max-width:600px;width:90vw;max-height:80vh;overflow-y:auto;box-shadow:0 25px 50px rgba(0,0,0,0.3)}

/* Panel repositionn√© en mode preview */
.color-picker-overlay.hud-preview-mode .color-picker-panel {
    max-width:450px;
    width:450px;
    margin-right:auto;
}.tabs{display:flex;gap:1rem;margin-bottom:2rem;border-bottom:1px solid rgba(148,163,184,0.2)}.tab-btn{background:transparent;border:none;color:var(--text-secondary);padding:0.5rem 1rem;cursor:pointer;border-bottom:2px solid transparent;transition:all 0.3s ease}.tab-btn.active{color:var(--primary);border-bottom-color:var(--primary)}.tab-content{display:none}.tab-content.active{display:block}.theme-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(100px,1fr));gap:1rem;margin:1rem 0}.theme-preview{width:100px;height:60px;border-radius:12px;border:2px solid transparent;cursor:pointer;transition:all 0.3s ease;position:relative;overflow:hidden}.theme-preview:hover{transform:scale(1.05);border-color:white}.theme-preview.active{border-color:var(--primary)}.language-item{display:flex;align-items:center;justify-content:space-between;background:linear-gradient(135deg,rgba(15,23,42,0.3),rgba(30,41,59,0.2));border-radius:15px;padding:1rem;border:1px solid rgba(6,182,212,0.15);margin-bottom:0.8rem}.cecrl-badge{background:linear-gradient(135deg,var(--primary),var(--secondary));color:white;padding:0.2rem 0.6rem;border-radius:12px;font-size:0.75rem;font-weight:600}.download-btn{background:linear-gradient(135deg,var(--primary),var(--secondary));color:white;padding:0.8rem 1.5rem;border-radius:8px;border:none;cursor:pointer;font-weight:600;transition:all 0.3s ease;text-decoration:none;display:inline-flex;align-items:center;gap:0.5rem}.download-btn:hover{transform:translateY(-2px);box-shadow:0 8px 25px rgba(6,182,212,0.3)}.main-grid{display:grid;grid-template-columns:1fr 2fr;gap:2rem;max-width:1100px;margin:0 auto;padding:2rem;position:relative;z-index:1}.portfolio-section{width:100%;max-width:1400px;margin:2rem auto 0;padding:0 2rem;position:relative;z-index:1}.portfolio-grid{display:flex;gap:1rem;overflow-x:auto;padding:1rem 0;scroll-behavior:smooth}.portfolio-card{background:linear-gradient(145deg,rgba(30,41,59,0.08),rgba(15,23,42,0.12));border:1px solid rgba(6,1
    
    /* Reset localStorage Long Press */
    .reset-progress{position:absolute;bottom:0;left:0;width:100%;height:4px;background:rgba(239,68,68,0.2);border-radius:0 0 50% 50%;opacity:0;pointer-events:none;transition:opacity 0.3s ease}.reset-progress::before{content:'';position:absolute;left:0;top:0;height:100%;width:var(--progress, 0%);background:linear-gradient(90deg,#ef4444,#dc2626);border-radius:inherit;transition:width 0.1s linear}.reset-progress.active{opacity:1}.reset-progress.complete{background:#10b981;opacity:1;animation:resetComplete 0.5s ease}.reset-progress.complete::before{width:100%!important;background:#10b981}@keyframes resetComplete{0%,100%{transform:scale(1)}50%{transform:scale(1.1)}}82,212,0.15);border-radius:24px;overflow:hidden;position:relative;backdrop-filter:blur(20px);transition:all 0.6s ease;cursor:pointer;min-width:300px;max-width:350px;flex-shrink:0}.portfolio-card:hover{transform:translateY(-8px) scale(1.02);border-color:rgba(6,182,212,0.4);box-shadow:0 20px 40px rgba(0,0,0,0.2),0 0 60px rgba(6,182,212,0.15)}.video-thumbnail{width:100%;height:180px;background:var(--dark-medium);position:relative;overflow:hidden}.video-thumbnail img{width:100%;height:100%;object-fit:cover}.video-description{padding:1.5rem}.carousel-nav{position:absolute;top:50%;background:rgba(15,23,42,0.8);border:none;color:var(--primary);width:40px;height:40px;border-radius:50%;cursor:pointer;z-index:10;transform:translateY(-50%);transition:all 0.3s ease}.carousel-nav:hover{background:rgba(6,182,212,0.2)}.carousel-prev{left:10px}.carousel-next{right:10px}.theater-overlay{position:fixed;top:0;left:0;width:100vw;height:100vh;background:rgba(15,23,42,0.95);backdrop-filter:blur(20px);z-index:10000;display:flex;align-items:center;justify-content:center;opacity:0;pointer-events:none;transition:all 0.4s ease}.theater-overlay.active{opacity:1;pointer-events:all}.theater-content{display:grid;grid-template-columns:2fr 1fr;gap:2rem;max-width:90vw;max-height:80vh}.theater-video{width:100%;height:60vh;border-radius:15px;border:none}.video-explanation{background:rgba(15,23,42,0.8);backdrop-filter:blur(15px);border-radius:15px;padding:1.5rem;border:1px solid rgba(6,182,212,0.2);max-height:60vh;overflow-y:auto;font-family:'Fira Code',monospace;font-size:13px;line-height:1.5}.close-theater{position:absolute;top:2rem;right:2rem;background:rgba(220,38,38,0.8);border:none;border-radius:50%;width:50px;height:50px;color:white;font-size:24px;cursor:pointer;transition:all 0.3s ease}.close-theater:hover{background:rgba(220,38,38,1);transform:scale(1.1)}.scroll-indicator{position:fixed;bottom:2rem;left:50%;transform:translateX(-50%);background:rgba(6,182,212,0.1);backdrop-filter:blur(15px);border:1px solid rgba(6,182,212,0.2);border-radius:30px;padding:1rem 1.5rem;display:flex;align-items:center;gap:0.5rem;color:var(--primary);cursor:pointer;transition:all 0.3s ease;z-index:1000;animation:pulseGlow 3s infinite}.scroll-indicator:hover{transform:translateX(-50%) translateY(-5px);background:rgba(6,182,212,0.15)}.scroll-arrow{animation:bounceDown 2s infinite}@keyframes bounceDown{0%,20%,50%,80%,100%{transform:translateY(0)}40%{transform:translateY(-10px)}60%{transform:translateY(-5px)}}@keyframes pulseGlow{0%,100%{box-shadow:0 0 5px rgba(6,182,212,0.2)}50%{box-shadow:0 0 20px rgba(6,182,212,0.4)}}@keyframes gamingPulse{0%,100%{box-shadow:0 8px 25px rgba(6,182,212,0.3)}50%{box-shadow:0 12px 35px rgba(6,182,212,0.5)}}@keyframes achievementGlow{0%,100%{box-shadow:0 10px 30px rgba(251,191,36,0.3)}50%{box-shadow:0 15px 40px rgba(251,191,36,0.5)}}.hud-preview-mode .game-hud,.hud-preview-mode .tamagotchi,.hud-preview-mode .game-notification,.hud-preview-mode .achievement-toast{border:2px dashed var(--primary);animation:previewPulse 2s ease-in-out infinite}@keyframes previewPulse{0%,100%{border-color:var(--primary);opacity:0.9}50%{border-color:var(--secondary);opacity:1}}.hud-preview-mode .game-hud::after,.hud-preview-mode .tamagotchi::after,.hud-preview-mode .game-notification::after,.hud-preview-mode .achievement-toast::after{content:'PREVIEW';position:absolute;top:-20px;left:50%;transform:translateX(-50%);background:var(--primary);color:white;padding:2px 8px;border-radius:4px;font-size:10px;font-weight:600;z-index:10001}.particle-controls{display:grid;grid-template-columns:1fr 1fr;gap:1rem;margin:1rem 0}.control-group{display:flex;flex-direction:column;gap:0.5rem}.control-group label{font-size:0.8rem;color:var(--text-secondary)}.control-input{background:rgba(15,23,42,0.5);border:1px solid rgba(148,163,184,0.2);border-radius:6px;padding:0.5rem;color:var(--text-primary)}.preset-buttons{display:grid;grid-template-columns:repeat(auto-fit,minmax(100px,1fr));gap:0.5rem;margin:1rem 0}.preset-btn{background:rgba(6,182,212,0.1);border:1px solid rgba(6,182,212,0.2);border-radius:8px;padding:0.5rem;color:var(--primary);cursor:pointer;transition:all 0.3s ease}.preset-btn:hover,.preset-btn.active{background:rgba(6,182,212,0.2);border-color:rgba(6,182,212,0.4)}@media (max-width:968px){.main-grid{grid-template-columns:1fr;padding:1rem}.lang-switch{top:1rem;right:1rem}.color-picker-trigger{top:1rem;right:6rem}.game-toggle{top:1rem;right:11rem}.game-hud{bottom:7rem;right:1.5rem;padding:0.5rem 0.8rem;font-size:0.75rem;gap:0.8rem}.achievement-toast{bottom:12rem;right:0.5rem;max-width:250px}.game-notification{bottom:8rem;right:1rem;max-width:220px}.tamagotchi{bottom:1.5rem;right:1.5rem;width:70px;height:70px}#gamingController{bottom:1.5rem;right:1.5rem;width:70px;height:70px}.theater-content{grid-template-columns:1fr;padding:1rem}.theater-video{height:40vh}}.fade-in{animation:fadeIn 0.6s ease}@keyframes fadeIn{from{opacity:0;transform:translateY(15px)}to{opacity:1;transform:translateY(0)}}.documentation-section{background:rgba(15,23,42,0.3);border-radius:12px;padding:1.5rem;margin:1rem 0}.faq-item{border-bottom:1px solid rgba(148,163,184,0.1);padding:1rem 0}.faq-question{cursor:pointer;display:flex;justify-content:space-between;align-items:center;font-weight:500}.faq-answer{margin-top:0.5rem;color:var(--text-secondary);display:none}.faq-item.open .faq-answer{display:block}.mini-game-overlay{position:fixed;top:0;left:0;width:100vw;height:100vh;background:rgba(15,23,42,0.95);backdrop-filter:blur(20px);z-index:10000;display:flex;align-items:center;justify-content:center;opacity:0;pointer-events:none;transition:all 0.5s ease}.mini-game-overlay.active{opacity:1;pointer-events:all}.mini-game{background:rgba(30,41,59,0.2);backdrop-filter:blur(25px);border-radius:24px;padding:2rem;max-width:600px;width:90vw;border:1px solid rgba(148,163,184,0.2)}.code-puzzle{background:rgba(15,23,42,0.8);border-radius:12px;padding:1.5rem;margin:1rem 0;font-family:'Fira Code',monospace;border:1px solid rgba(6,182,212,0.2)}.qcm-options{display:grid;gap:0.5rem;margin:1rem 0}.qcm-option{background:rgba(15,23,42,0.3);border:1px solid rgba(148,163,184,0.3);border-radius:8px;padding:0.75rem;color:var(--text-primary);cursor:pointer;transition:all 0.3s ease;text-align:left}.qcm-option:hover:not(:disabled){background:rgba(6,182,212,0.1);border-color:rgba(6,182,212,0.3)}.qcm-option:disabled{cursor:not-allowed;opacity:0.7}.game-button{background:linear-gradient(135deg,var(--primary),var(--secondary));color:white;border:none;padding:0.75rem 1.5rem;border-radius:8px;cursor:pointer;font-weight:600;transition:all 0.3s ease;margin:0.5rem}.game-button:hover{transform:translateY(-2px);box-shadow:0 5px 15px rgba(6,182,212,0.3)}.portrait-dialogue{position:fixed;background:rgba(15,23,42,0.98);border:2px solid var(--primary);border-radius:15px;padding:1rem;max-width:280px;min-height:60px;font-size:0.8rem;opacity:0;pointer-events:none;transition:all 0.3s ease;z-index:10005;box-shadow:0 15px 40px rgba(0,0,0,0.5);backdrop-filter:blur(15px);display:flex;align-items:center}.portrait-dialogue.show{opacity:1;pointer-events:all}.portrait-dialogue::after{content:'';position:absolute;border:10px solid transparent;z-index:-1}.portrait-dialogue.arrow-bottom::after{top:100%;left:var(--arrow-offset, 50%);transform:translateX(-50%);border-top-color:var(--primary)}.portrait-dialogue.arrow-top::after{bottom:100%;left:var(--arrow-offset, 50%);transform:translateX(-50%);border-bottom-color:var(--primary)}.portrait-dialogue.arrow-left::after{top:var(--arrow-offset, 50%);right:100%;transform:translateY(-50%);border-right-color:var(--primary)}.portrait-dialogue.arrow-right::after{top:var(--arrow-offset, 50%);left:100%;transform:translateY(-50%);border-left-color:var(--primary)}.game-notification{position:fixed;bottom:8rem;right:2rem;background:linear-gradient(135deg,var(--primary),var(--secondary));color:white;padding:0.8rem 1rem;border-radius:12px;max-width:250px;opacity:0;transform:translateX(100%);transition:all 0.5s ease;z-index:10001;font-size:0.85rem;box-shadow:0 8px 25px rgba(6,182,212,0.3);border:1px solid rgba(255,255,255,0.1)}.game-notification.show{opacity:1;transform:translateX(0)}.game-notification::before{content:'üéÆ';position:absolute;top:-8px;left:8px;background:var(--dark);border-radius:50%;width:20px;height:20px;display:flex;align-items:center;justify-content:center;font-size:10px;border:1px solid var(--primary)}.game-notification.show{opacity:1;transform:translateX(0)}.tech-tag{background:rgba(6,182,212,0.1);color:var(--primary);padding:0.2rem 0.6rem;border-radius:12px;font-size:0.7rem;border:1px solid rgba(6,182,212,0.2);margin:0.2rem}
    </style>
</head>
<body>
    <canvas id="particleCanvas"></canvas>
    
    <!-- Language Switch -->
    <div class="lang-switch">
        <button class="lang-btn active" onclick="switchLanguage('fr')" data-lang-key="fr">FR</button>
        <button class="lang-btn" onclick="switchLanguage('en')" data-lang-key="en">EN</button>
    </div>

    <!-- Game Toggle (Hidden by default) -->
    <div class="game-toggle" id="gameToggle" onclick="toggleGaming()" title="Mode Gaming">
        üéÆ
    </div>

    <!-- Color Picker Trigger -->
    <div class="color-picker-trigger" onclick="openColorPicker()" title="Personnaliser">
        <i class="fas fa-palette"></i>
    </div>

    <!-- Gaming HUD (removed from top-left, now in Gaming Zone) -->

    <!-- Gaming Zone (Bottom Right) -->
    
    <!-- Gaming HUD Stats -->
    <div class="game-hud" id="gameHUD">
        <div class="game-stat">
            <i class="fas fa-trophy"></i>
            <span id="scoreDisplay">0</span>
        </div>
        <div class="game-stat">
            <i class="fas fa-star"></i>
            <span id="xpDisplay">0</span> XP
        </div>
        <div class="game-stat">
            <i class="fas fa-medal"></i>
            <span id="levelDisplay">1</span>
        </div>
        <div class="xp-bar">
            <div class="xp-progress" id="xpProgress"></div>
        </div>
    </div>
    
    <!-- Achievement Toast -->
    <div class="achievement-toast" id="achievementToast">
        <div class="achievement-icon">üèÜ</div>
        <h4 id="achievementTitle">Achievement Unlocked!</h4>
        <p id="achievementDesc">Description</p>
    </div>

    <!-- Game Notification -->
    <div class="game-notification" id="gameNotification">
        <div id="notificationText"></div>
    </div>

    <!-- Tamagotchi (√âric le chat) -->
    <div class="tamagotchi" id="tamagotchi" onclick="feedTamagotchi()" oncontextmenu="toggleGamingFromEric(event)">
    <img
    id="tamagotchiIcon"
    src="assets/images/eric-cat.png"
    style="width:100%;height:100%;object-fit:cover;border-radius:50%;cursor:pointer;"
    alt="√âric le chat"
    />
    <!-- Tooltip interactif -->
    <div class="tama-tooltip" id="tamaTooltip">
        <div style="font-weight:600;margin-bottom:2px;">üê± √âric - Niveau <span id="tamaLevelDisplay">1</span></div>
        <div style="font-size:0.75rem;opacity:0.9;">
            <span class="tama-stat-icon">üçî</span> Faim: <span id="tamaHungerDisplay">100</span>%
            <span style="margin:0 4px;">|</span>
            <span class="tama-stat-icon">üòä</span> Humeur: <span id="tamaMoodDisplay">100</span>%
        </div>
        <div style="font-size:0.7rem;opacity:0.7;margin-top:4px;border-top:1px solid rgba(255,255,255,0.2);padding-top:4px;">
            üëÜ Clic: Nourrir | üëÜüëÜ Double-clic: Jouer
        </div>
    </div>
    </div>

    <!-- Gaming Controller Button (hidden by default, replaces Eric when gaming is disabled) -->
    <div class="tamagotchi" id="gamingController" onclick="reactivateGaming()" style="display:none;background:rgba(139,92,246,0.2);border-color:var(--accent);">
        <i class="fas fa-gamepad" style="font-size:2rem;color:var(--accent);"></i>
    </div>

    <!-- Mini-Games Trigger Button -->
    <div class="minigames-trigger" id="minigamesTrigger" onclick="openMinigamesMenu()" title="Mini-jeux">
        üéÆ
    </div>

    <!-- Mini-Games Modal -->
    <div class="minigame-modal" id="minigameModal" onclick="closeMinigame()">
        <div class="minigame-container" onclick="event.stopPropagation()">
            <div class="minigame-header">
                <h2 class="minigame-title" id="minigameTitle">üéÆ Mini-Jeux</h2>
                <button class="minigame-close" onclick="closeMinigame()">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="minigame-content" id="minigameContent">
                <!-- Content dynamique g√©n√©r√© par JS -->
            </div>
        </div>
    </div>

    <!-- Color Picker Overlay -->
    <div class="color-picker-overlay" id="colorPickerOverlay" onclick="closeColorPicker(event)">
        <div class="color-picker-panel" onclick="event.stopPropagation()">
            <div class="flex justify-between items-center mb-4">
                <h3 class="text-xl font-bold text-white">üé® Personnalisation</h3>
                <button onclick="closeColorPicker()" class="text-gray-400 hover:text-white">
                    <i class="fas fa-times"></i>
                </button>
            </div>

            <div class="tabs">
                <button class="tab-btn active" onclick="switchTab('colors')">
                    <i class="fas fa-desktop mr-2"></i>Interface
                </button>
                <button class="tab-btn" onclick="switchTab('particles')">
                    <i class="fas fa-sparkles mr-2"></i>Particules
                </button>
                <button class="tab-btn" onclick="switchTab('gaming')">
                    <i class="fas fa-gamepad mr-2"></i>Gaming
                </button>
                <button class="tab-btn" onclick="switchTab('documentation')">
                    <i class="fas fa-book mr-2"></i>Guide
                </button>
            </div>

            <!-- Colors Tab -->
            <div id="colorsTab" class="tab-content active">
                <div class="documentation-section">
                    <h4 class="text-lg font-semibold mb-2 text-white">Th√®mes Pr√©d√©finis</h4>
                    <div class="theme-grid" id="themeGrid"></div>
                </div>

                <div class="documentation-section">
                    <h4 class="text-lg font-semibold mb-2 text-white">Couleurs Personnalis√©es</h4>
                    <div class="grid grid-cols-2 gap-4">
                        <div class="control-group">
                            <label>Couleur Principale</label>
                            <input type="color" id="primaryColor" class="control-input" value="#06b6d4" onchange="updateCustomColors()">
                        </div>
                        <div class="control-group">
                            <label>Couleur Secondaire</label>
                            <input type="color" id="secondaryColor" class="control-input" value="#10b981" onchange="updateCustomColors()">
                        </div>
                    </div>
                </div>

                <div class="documentation-section">
                    <h4 class="text-lg font-semibold mb-2 text-white">üéÆ Personnalisation HUD Gaming</h4>
                    <div class="grid grid-cols-1 gap-4">
                        <div class="control-group">
                            <label>Couleur de fond du HUD</label>
                            <input type="color" id="hudBgColor" class="control-input" value="#0f172a" onchange="updateHudStyles()">
                        </div>
                        <div class="control-group">
                            <label>Transparence du HUD: <span id="hudOpacityValue">90%</span></label>
                            <input type="range" id="hudOpacity" class="control-input" min="10" max="100" value="90" onchange="updateHudStyles()">
                        </div>
                        <div class="control-group">
                            <label>Transparence du fond: <span id="hudBgOpacityValue">90%</span></label>
                            <input type="range" id="hudBgOpacity" class="control-input" min="10" max="100" value="90" onchange="updateHudStyles()">
                        </div>
                    </div>
                    <div class="flex gap-2 mt-4">
                        <button class="preset-btn" onclick="resetHudStyles()">Reset HUD</button>
                    </div>
                </div>

                <div class="documentation-section">
                    <h4 class="text-lg font-semibold mb-2 text-white">üìê Positionnement du HUD Gaming</h4>
                    <div class="grid grid-cols-2 gap-4">
                        <div class="control-group">
                            <label>Position √âric - Bas: <span id="ericBottomValue">3.5rem</span></label>
                            <input type="range" id="ericBottom" class="control-input" min="1" max="10" value="3.5" step="0.5" onchange="updateHudPositions()">
                        </div>
                        <div class="control-group">
                            <label>Position √âric - Droite: <span id="ericRightValue">2rem</span></label>
                            <input type="range" id="ericRight" class="control-input" min="1" max="10" value="2" step="0.5" onchange="updateHudPositions()">
                        </div>
                        <div class="control-group">
                            <label>Taille d'√âric: <span id="ericSizeValue">88px</span></label>
                            <input type="range" id="ericSize" class="control-input" min="60" max="120" value="88" onchange="updateHudPositions()">
                        </div>
                        <div class="control-group">
                            <label>Position HUD - Bas: <span id="hudBottomValue">5rem</span></label>
                            <input type="range" id="hudBottom" class="control-input" min="5" max="20" value="5" step="0.5" onchange="updateHudPositions()">
                        </div>
                        <div class="control-group">
                            <label>Position HUD - Droite: <span id="hudRightValue">2rem</span></label>
                            <input type="range" id="hudRight" class="control-input" min="1" max="10" value="2" step="0.5" onchange="updateHudPositions()">
                        </div>
                        <div class="control-group">
                            <label>Taille HUD: <span id="hudScaleValue">100%</span></label>
                            <input type="range" id="hudScale" class="control-input" min="70" max="130" value="100" onchange="updateHudPositions()">
                        </div>
                        <div class="control-group">
                            <label>Position Notif - Bas: <span id="notifBottomValue">11rem</span></label>
                            <input type="range" id="notifBottom" class="control-input" min="3" max="15" value="11" step="0.5" onchange="updateHudPositions()">
                        </div>
                        <div class="control-group">
                            <label>Position Notif - Droite: <span id="notifRightValue">2rem</span></label>
                            <input type="range" id="notifRight" class="control-input" min="1" max="10" value="2" step="0.5" onchange="updateHudPositions()">
                        </div>
                        <div class="control-group">
                            <label>Position Achievements - Bas: <span id="achievBottomValue">15.5rem</span></label>
                            <input type="range" id="achievBottom" class="control-input" min="8" max="20" value="15.5" step="0.5" onchange="updateHudPositions()">
                        </div>
                        <div class="control-group">
                            <label>Position Achievements - Droite: <span id="achievRightValue">1rem</span></label>
                            <input type="range" id="achievRight" class="control-input" min="0" max="8" value="1" step="0.5" onchange="updateHudPositions()">
                        </div>
                    </div>
                    <div class="flex gap-2 mt-4">
                        <button class="preset-btn" onclick="resetHudPositions()">Reset Positions</button>
                        <button class="preset-btn" onclick="applyPresetLayout('compact')">Layout Compact</button>
                        <button class="preset-btn" onclick="applyPresetLayout('spacious')">Layout Spacieux</button>
                        <button class="preset-btn" id="previewToggle" onclick="toggleHudPreview()">
                            <i class="fas fa-eye mr-1"></i>Pr√©visualiser
                        </button>
                    </div>
                </div>
            </div>

            <!-- Particles Tab -->
            <div id="particlesTab" class="tab-content">
                <div class="documentation-section">
                    <h4 class="text-lg font-semibold mb-2 text-white">Presets Particules</h4>
                    <div class="preset-buttons">
                        <button class="preset-btn" onclick="applyParticlePreset('minimal')">Minimal</button>
                        <button class="preset-btn active" onclick="applyParticlePreset('classic')">Classic</button>
                        <button class="preset-btn" onclick="applyParticlePreset('dynamic')">Dynamic</button>
                        <button class="preset-btn" onclick="applyParticlePreset('cosmic')">Cosmic</button>
                    </div>
                </div>

                <div class="particle-controls">
                    <div class="control-group">
                        <label>Type</label>
                        <select id="particleType" class="control-input" onchange="updateParticles()">
                            <option value="circle">Cercles</option>
                            <option value="star">√âtoiles</option>
                            <option value="triangle">Triangles</option>
                            <option value="line">Lignes</option>
                            <option value="pixel">Pixels</option>
                        </select>
                    </div>
                    <div class="control-group">
                        <label>Mouvement</label>
                        <select id="particleMovement" class="control-input" onchange="updateParticles()">
                            <option value="float">Flottant</option>
                            <option value="spiral">Spirale</option>
                            <option value="wave">Vagues</option>
                            <option value="magnetic">Magn√©tique</option>
                            <option value="orbital">Orbital</option>
                        </select>
                    </div>
                    <div class="control-group">
                        <label>Intensit√©: <span id="intensityValue">50</span></label>
                        <input type="range" id="particleIntensity" class="control-input" min="20" max="200" value="50" onchange="updateParticles()">
                    </div>
                    <div class="control-group">
                        <label>Vitesse</label>
                        <select id="particleSpeed" class="control-input" onchange="updateParticles()">
                            <option value="slow">Lente</option>
                            <option value="normal" selected>Normale</option>
                            <option value="fast">Rapide</option>
                            <option value="ultra">Ultra-rapide</option>
                        </select>
                    </div>
                    <div class="control-group">
                        <label>Taille</label>
                        <select id="particleSize" class="control-input" onchange="updateParticles()">
                            <option value="micro">Micro</option>
                            <option value="small" selected>Petite</option>
                            <option value="medium">Moyenne</option>
                            <option value="large">Grande</option>
                        </select>
                    </div>
                    <div class="control-group">
                        <label>Opacit√©</label>
                        <select id="particleOpacity" class="control-input" onchange="updateParticles()">
                            <option value="subtle" selected>Subtile</option>
                            <option value="visible">Visible</option>
                            <option value="intense">Intense</option>
                        </select>
                    </div>
                </div>

                <div class="flex gap-2 mt-4">
                    <button class="download-btn" onclick="resetParticles()">
                        <i class="fas fa-undo mr-2"></i>Reset
                    </button>
                    <button class="download-btn" onclick="saveParticleSettings()">
                        <i class="fas fa-save mr-2"></i>Sauvegarder
                    </button>
                </div>
            </div>

            <!-- Gaming Tab -->
            <div id="gamingTab" class="tab-content">
                <div class="documentation-section">
                    <h4 class="text-lg font-semibold mb-4 text-white">üéÆ Mode Gaming</h4>
                    <div class="space-y-6">
                        <!-- Stats Section -->
                        <div class="bg-gray-800 bg-opacity-30 rounded-lg p-4">
                            <h5 class="text-md font-medium mb-3 text-white">üìä Statistiques</h5>
                            <div class="space-y-2">
                                <p class="text-sm text-gray-300">Score Total: <span id="totalScore" class="text-primary font-bold">0</span></p>
                                <p class="text-sm text-gray-300">Succ√®s: <span id="totalAchievements" class="text-primary font-bold">0</span>/<span id="maxAchievements" class="text-secondary font-bold">0</span></p>
                                <p class="text-sm text-gray-300">Niveau d'√©ric: <span id="tamaLevel" class="text-primary font-bold">1</span></p>
                            </div>
                        </div>

                        <!-- Achievements Section -->
                        <div class="bg-gray-800 bg-opacity-30 rounded-lg p-4">
                            <h5 class="text-md font-medium mb-3 text-white">üèÜ Succ√®s D√©bloqu√©s</h5>
                            <div id="achievementsList" class="space-y-2 max-h-40 overflow-y-auto">
                                <p class="text-xs text-gray-400 italic">Aucun succ√®s d√©bloqu√© pour le moment</p>
                            </div>
                        </div>

                        <!-- Actions Section -->
                        <div class="space-y-2">
                            <button class="game-button w-full" onclick="startMiniGame()">üß© Mini-Jeu</button>
                            <button class="game-button w-full bg-red-600 hover:bg-red-700" onclick="resetProfile()">üîÑ Reset Profile</button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Documentation Tab -->
            <div id="documentationTab" class="tab-content">
                <div class="documentation-section">
                    <h4 class="text-lg font-semibold mb-2 text-white">üöÄ Guide d'Utilisation</h4>
                    <div class="text-sm text-gray-300 space-y-2">
                        <p><strong>Navigation :</strong></p>
                        <ul class="list-disc list-inside space-y-1 ml-4">
                            <li>Switch FR/EN en haut √† droite</li>
                            <li>Mode Gaming avec le bouton üéÆ (cliquez 3x sur portrait)</li>
                            <li>Portfolio vid√©o : clic pour th√©√¢tre</li>
                            <li>Particules interactives personnalisables</li>
                        </ul>
                        
                        <p><strong>Gaming :</strong></p>
                        <ul class="list-disc list-inside space-y-1 ml-4">
                            <li>Cliquez sur ma photo pour dialogues rigolos</li>
                            <li>Explorez les comp√©tences pour gagner XP</li>
                            <li>Tamagotchi √©volue selon vos actions</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Mini Game Overlay -->
    <div class="mini-game-overlay" id="miniGameOverlay" onclick="closeMiniGame(event)">
        <div class="mini-game" onclick="event.stopPropagation()">
            <h2 style="text-align: center; color: var(--primary); margin-bottom: 1rem;">
                üß© <span data-lang="quizTitle">Tech Quest - Code Challenge</span>
            </h2>
            <button class="close-theater" onclick="closeMiniGame()" style="position: absolute; top: 1rem; right: 1rem;">√ó</button>
            
            <div id="miniGameContent">
                <div class="code-puzzle">
                    <h3 id="quizQuestion">Question...</h3>
                </div>
                
                <div class="qcm-options" id="qcmOptions"></div>
                
                <div style="text-align: center; margin-top: 1rem;">
                    <button class="game-button" onclick="generateNewPuzzle()" data-lang="newQuestion">Nouvelle Question</button>
                </div>
                
                <div id="puzzleResult" style="margin-top: 1rem; text-align: center;"></div>
            </div>
        </div>
    </div>

    <div class="main-grid">
        <!-- Left Column -->
        <div class="space-y-6">
            <!-- Profile Header -->
            <div class="glass-subtle p-6 text-center fade-in" data-action="profile-view">
                <div style="position: relative;">
                    <img src="https://page.gensparksite.com/v1/base64_upload/8459e20749ce811147057016f8c7cf5c" 
                         alt="Samir Medjaher" 
                         class="profile-img mx-auto mb-4"
                         id="profileImage"
                         onclick="triggerPortraitDialogue()"
                         onmousedown="startResetTimer(event)"
                         onmouseup="cancelResetTimer()"
                         onmouseleave="cancelResetTimer()"
                         ontouchstart="startResetTimer(event)"
                         ontouchend="cancelResetTimer()"
                         ontouchcancel="cancelResetTimer()"
                         onerror="this.src='data:image/svg+xml,%3Csvg xmlns=%22http://www.w3.org/2000/svg%22 width=%22140%22 height=%22140%22 viewBox=%220 0 140 140%22%3E%3Ccircle cx=%2270%22 cy=%2270%22 r=%2770%22 fill=%22%23334155%22/%3E%3Ctext x=%2270%22 y=%2280%22 text-anchor=%22middle%22 fill=%22%236b21f8%22 font-size=%2248%22 font-family=%22Inter%22 font-weight=%22600%22%3ESM%3C/text%3E%3C/svg%3E'">
                    <!-- Reset progress indicator -->
                    <div id="resetProgress" class="reset-progress"></div>
                </div>
                
                <h1 class="text-2xl font-bold text-white mb-2" style="color: var(--primary);">
                    Samir Medjaher
                </h1>
                <h2 class="text-lg text-gray-300 mb-4 font-medium" data-lang="jobTitle">
                    Technicien IT & D√©veloppeur Junior
                </h2>
                <p class="text-sm text-gray-400" data-lang="age">
                    38 ans ‚Ä¢ Recherche stabilit√© et √©volution
                </p>
            </div>

            <!-- Contact -->
            <div class="glass-card p-4 fade-in">
                <h3 class="section-title">
                    <i class="fas fa-address-card"></i>
                    <span data-lang="contactTitle">Contact</span>
                </h3>
                <div class="space-y-2">
                    <div class="contact-item" onclick="openMail()" data-action="contact-email">
                        <i class="fas fa-envelope"></i>
                        <span>s.medjaher@gmail.com</span>
                    </div>
                    <div class="contact-item" onclick="callPhone()">
                        <i class="fas fa-phone"></i>
                        <span>+33.7.80.75.75.76</span>
                    </div>
                    <div class="contact-item" onclick="openMaps()">
                        <i class="fas fa-map-marker-alt"></i>
                        <span>69140 Rillieux-la-Pape, France</span>
                    </div>
                    <div class="contact-item" onclick="openGitHub()" data-action="contact-github">
                        <i class="fab fa-github"></i>
                        <span>github.com/Duperopope</span>
                    </div>
                </div>
            </div>

            <!-- Skills -->
            <div class="glass-card p-4 fade-in">
                <h3 class="section-title">
                    <i class="fas fa-cogs"></i>
                    <span data-lang="skillsTitle">Comp√©tences Techniques</span>
                </h3>
                
                <div class="space-y-4">
                    <div>
                        <h4 class="text-sm font-medium text-gray-300 mb-2" data-lang="programmingTitle">D√©veloppement</h4>
                        <div class="flex flex-wrap" id="developmentSkills"></div>
                    </div>
                    <div>
                        <h4 class="text-sm font-medium text-gray-300 mb-2" data-lang="gamedevTitle"></h4>
                        <div class="flex flex-wrap" id="gamedevSkills"></div>
                    </div>
                    <div>
                        <h4 class="text-sm font-medium text-gray-300 mb-2" data-lang="systemsTitle">Syst√®mes & R√©seau</h4>
                        <div class="flex flex-wrap" id="systemsSkills"></div>
                    </div>
                    <div>
                        <h4 class="text-sm font-medium text-gray-300 mb-2" data-lang="toolsTitle"></h4>
                        <div class="flex flex-wrap" id="toolsSkills"></div>
                    </div>
                </div>
            </div>

            <!-- Hobbies -->
            <div class="glass-card p-4 fade-in">
                <h3 class="section-title">
                    <i class="fas fa-heart"></i>
                    <span data-lang="hobbiesTitle">Centres d'Int√©r√™t</span>
                </h3>
                <div class="space-y-3">
                    <div class="flex items-start gap-3 p-3 bg-gray-800 bg-opacity-20 rounded-lg">
                        <i class="fas fa-guitar text-blue-400 mt-1"></i>
                        <div>
                            <h4 class="text-white font-medium text-sm mb-1" data-lang="hobby1Title"></h4>
                            <p class="text-gray-300 text-xs leading-relaxed" data-lang="hobby1Desc"></p>
                        </div>
                    </div>
                    <div class="flex items-start gap-3 p-3 bg-gray-800 bg-opacity-20 rounded-lg">
                        <i class="fas fa-microphone text-green-400 mt-1"></i>
                        <div>
                            <h4 class="text-white font-medium text-sm mb-1">Chant</h4>
                            <h4 class="text-white font-medium text-sm mb-1" data-lang="hobby2Title"></h4>
                        </div>
                    </div>
                    <div class="flex items-start gap-3 p-3 bg-gray-800 bg-opacity-20 rounded-lg">
                        <i class="fas fa-book text-purple-400 mt-1"></i>
                        <div>
                            <h4 class="text-white font-medium text-sm mb-1" data-lang="hobby3Title"></h4>
                            <p class="text-gray-300 text-xs leading-relaxed" data-lang="hobby3Desc"></p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Languages -->
            <div class="glass-card p-4 fade-in">
                <h3 class="section-title">
                    <i class="fas fa-language"></i>
                    <span data-lang="languagesTitle">Langues</span>
                </h3>
                <div class="space-y-3" id="languagesContent"></div>
            </div>

            <!-- Download -->
            <div class="text-center fade-in">
                <a id="downloadLink" href="#" class="download-btn" target="_blank" rel="noopener" onclick="triggerAction('download-pdf')">
                    <i class="fas fa-download"></i>
                    <span data-lang="downloadPdf">T√©l√©charger PDF</span>
                </a>
            </div>
        </div>

        <!-- Right Column -->
        <div class="space-y-6">
            <!-- Objective -->
            <div class="glass-card p-6 fade-in">
                <h3 class="section-title">
                    <i class="fas fa-target"></i>
                    <span data-lang="objectiveTitle">Objectif Professionnel</span>
                </h3>
                <p class="text-gray-300 text-sm leading-relaxed" data-lang="objectiveText">
                    Reconversion assum√©e vers les technologies de l'information. √Ä 38 ans, je recherche un environnement stable o√π d√©velopper mes comp√©tences techniques acquises en autodidacte et contribuer efficacement √† des projets concrets. Mon exp√©rience de vie vari√©e et mon ouverture internationale sont des atouts que je souhaite mettre au service d'une √©quipe dynamique.
                </p>
            </div>

            <!-- Experience -->
            <div class="glass-card p-5 fade-in">
                <h3 class="section-title">
                    <i class="fas fa-briefcase"></i>
                    <span data-lang="experienceTitle">Exp√©rience Professionnelle</span>
                </h3>
                <div class="space-y-4" id="experienceContent"></div>
            </div>

            <!-- Formation -->
            <div class="glass-card p-5 fade-in">
                <h3 class="section-title">
                    <i class="fas fa-graduation-cap"></i>
                    <span data-lang="educationTitle">Formation</span>
                </h3>
                <div class="space-y-4" id="educationContent"></div>
            </div>

            <!-- Projects -->
            <div class="glass-card p-5 fade-in">
                <h3 class="section-title">
                    <i class="fas fa-code-branch"></i>
                    <span data-lang="projectsTitle">Projets Personnels</span>
                </h3>
                <div class="space-y-3" id="projectsContent"></div>
            </div>

            <!-- International -->
            <div class="glass-card p-5 fade-in">
                <h3 class="section-title">
                    <i class="fas fa-globe"></i>
                    <span data-lang="internationalTitle">Exp√©rience Internationale</span>
                </h3>
                <div class="space-y-3" id="internationalContent"></div>
            </div>
        </div>
    </div>

    <!-- Portfolio Section -->
    <div class="portfolio-section">
        <div class="text-center mb-8">
            <h2 class="text-3xl font-bold text-white mb-4" data-lang="portfolioTitle" style="color: var(--primary);">
                Portfolio Vid√©o
            </h2>
            <p class="text-gray-300" data-lang="portfolioSubtitle">
                Mes r√©alisations techniques en Game Development
            </p>
        </div>

        <div style="position: relative;">
            <button class="carousel-nav carousel-prev" onclick="slideCarousel(-1)">
                <i class="fas fa-chevron-left"></i>
            </button>
            <button class="carousel-nav carousel-next" onclick="slideCarousel(1)">
                <i class="fas fa-chevron-right"></i>
            </button>
            <div class="portfolio-grid" id="portfolioGrid"></div>
        </div>
    </div>

    <!-- Theater Overlay -->
    <div id="theaterOverlay" class="theater-overlay" onclick="closeTheater(event)">
        <button class="close-theater" onclick="closeTheater()">√ó</button>
        <div class="theater-content" onclick="event.stopPropagation()">
            <div>
                <iframe id="theaterVideo" class="theater-video" src="" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe>
            </div>
            <div class="video-explanation" id="videoExplanation"></div>
        </div>
    </div>

    <!-- Scroll Indicator -->
    <div class="scroll-indicator" id="scrollIndicator" onclick="scrollToPortfolio()">
        <span data-lang="scrollText">Voir le portfolio</span>
        <i class="fas fa-chevron-down scroll-arrow"></i>
    </div>

    <!-- Portrait Dialogue -->
    <div class="portrait-dialogue" id="portraitDialogue">
        <span id="portraitText"></span>
    </div>

    <script>
        // Global Variables
        let currentLang = localStorage.getItem('preferredLanguage') || 'fr';
        let particleSystem;
        let gamingMode = localStorage.getItem('gamingMode') === 'true';
        
        // Load game stats with proper Set conversion
        let gameStats = (() => {
            const saved = JSON.parse(localStorage.getItem('gameStats') || '{"score":0,"xp":0,"level":1,"achievements":[],"tamaLevel":1,"skillsExplored":[],"videosWatched":[]}');
            return {
                ...saved,
                skillsExplored: new Set(saved.skillsExplored || []),
                videosWatched: new Set(saved.videosWatched || [])
            };
        })();
        
        let currentTheme = JSON.parse(localStorage.getItem('cv-theme') || '{"name":"Classic","primary":"#06b6d4","secondary":"#10b981","accent":"#8b5cf6"}');
        let typewriterInstances = new Map();
        let carouselIndex = 0;
        let portraitClicks = parseInt(localStorage.getItem('portraitClicks') || '0');
        let gamingUnlocked = localStorage.getItem('gamingUnlocked') === 'true';
        
        // Language switching tracking
        let languageSwitchCount = 0;
        let lastSwitchTime = 0;
        let rapidSwitchMode = false;
        let rapidSwitchCounter = 0;
        
        // Initialize timer variable
        window.portraitDialogueTimeout = null;
        
        // Portrait message cycling system
        if (!window.portraitMessageCycle) {
            window.portraitMessageCycle = {
                fr: { available: [], seen: new Set() },
                en: { available: [], seen: new Set() }
            };
        }

        // Welcome message system
        const welcomeMessages = {
            fr: {
                first: [
                    "Bienvenue sur mon CV interactif ! üëã",
                    "Salut ! Pr√™t pour une visite guid√©e ?",
                    "Bonjour ! Explorez mon univers tech !",
                    "Hey ! Bienvenue dans mon portfolio digital !"
                ],
                return: [
                    "Ah ! Ravi de vous revoir ! üòä",
                    "De retour ? J'esp√®re que √ßa vous pla√Æt !",
                    "Content de vous retrouver ! üéâ",
                    "Vous revoil√† ! Merci de revenir !"
                ]
            },
            en: {
                first: [
                    "Welcome to my interactive CV! üëã",
                    "Hi! Ready for a guided tour?",
                    "Hello! Explore my tech universe!",
                    "Hey! Welcome to my digital portfolio!"
                ],
                return: [
                    "Ah! Great to see you again! üòä",
                    "Back again? I hope you like it!",
                    "Happy to see you back! üéâ",
                    "You're back! Thanks for returning!"
                ]
            }
        };

        // Language switch messages
        const languageSwitchMessages = {
            toFrench: [
                "Ah ! Je peux parler fran√ßais ! üá´üá∑",
                "Parfait ! Passons au fran√ßais ! üòä",
                "Tr√®s bien ! En fran√ßais maintenant !",
                "Super ! Fran√ßais activ√© ! ‚ú®"
            ],
            toEnglish: [
                "Great! I can speak English! üá¨üáß",
                "Perfect! Let's switch to English! üòä",
                "Wonderful! English mode activated!",
                "Awesome! English it is! ‚ú®"
            ],
            confusion: [
                "Ahhh j'en perds mon latin ! Suis-je polyglotte ? ü§Ø",
                "Ahhh I'm losing my Latin! Am I multilingual? ü§Ø"
            ],
            funny: [
                "Vous trouvez √ßa funny ? Moi aussi ! üòÑ",
                "Do you find it dr√¥le? Me too! üòÑ"
            ],
            philosophical: [
                "La vie est un livre, aurez-vous le temps d'√©crire le v√¥tre ? üìñ‚ú®"
            ],
            wisdom: [
                "La sagesse s'acquiert √† force de faire des b√™tises... ou l'inverse ? ü§îüí´"
            ]
        };
        
        const tamaIcons = {
        normal:   'assets/images/eric-normal.png',
        hungry:   'assets/images/eric-hungry.png',
        fed:      'assets/images/eric-fed.png',
        happy:    'assets/images/eric-happy.png',
        unhappy:  'assets/images/eric-unhappy.png',
        sleeping: 'assets/images/eric-sleeping.png',
        boxed:    'assets/images/eric-boxed.png',
        ko:       'assets/images/eric-ko.png'
        };


        function updateTamaIcon() {
        const iconEl = document.getElementById('tamagotchiIcon');
        if (!gamingMode) return;
        // Exemples de conditions‚ÄØ; adapte selon tes stats r√©elles
        if (gameStats.tamaLevel === 1 && !gameStats.interacted) {
            iconEl.src = tamaIcons.boxed;
        }
        else if (gameStats.hunger < 30) {
            iconEl.src = tamaIcons.hungry;
        }
        else if (gameStats.mood < 30) {
            iconEl.src = tamaIcons.unhappy;
        }
        else if (gameStats.isSleeping) {
            iconEl.src = tamaIcons.sleeping;
        }
        else if (gameStats.tamaLevel >= 10) {
            iconEl.src = tamaIcons.happy;
        }
        else {
            iconEl.src = tamaIcons.normal;
        }
        }



        // Translations
        const translations = {
            fr: {
                jobTitle: "Technicien IT & D√©veloppeur Junior",
                age: "38 ans ‚Ä¢ Recherche stabilit√© et √©volution",
                contactTitle: "Contact",
                skillsTitle: "Comp√©tences Techniques",
                programmingTitle: "D√©veloppement",
                systemsTitle: "Syst√®mes & R√©seau",
                toolsTitle: "Outils",
                gamedevTitle: "Game Dev",
                languagesTitle: "Langues",
                hobbiesTitle: "Centres d'Int√©r√™t",
                downloadPdf: "T√©l√©charger PDF",
                objectiveTitle: "Objectif Professionnel",
                objectiveText: "Reconversion assum√©e vers les technologies de l'information. √Ä 38 ans, je recherche un environnement stable o√π d√©velopper mes comp√©tences techniques acquises en autodidacte et contribuer efficacement √† des projets concrets. Mon exp√©rience de vie vari√©e et mon ouverture internationale sont des atouts que je souhaite mettre au service d'une √©quipe dynamique.",
                experienceTitle: "Exp√©rience Professionnelle",
                educationTitle: "Formation",
                projectsTitle: "Projets Personnels",
                internationalTitle: "Exp√©rience Internationale",
                portfolioTitle: "Portfolio Vid√©o",
                portfolioSubtitle: "Mes r√©alisations techniques en Game Development",
                scrollText: "Voir le portfolio",
                quizTitle: "Tech Quest - D√©fi Code",
                newQuestion: "Nouvelle Question",
                hobby1Title: "Guitare",
                hobby1Desc:  "Passion musicale, cr√©ativit√© artistique",
                hobby2Title: "Chant",
                hobby2Desc:  "Expression artistique, performance",
                hobby3Title: "Philosophie",
                hobby3Desc:  "R√©flexion, analyse critique",
                experiences: [
                    {title: "Travailleur Ind√©pendant / Freelance", company: "2024 - Pr√©sent ‚Ä¢ Missions Tech", description: "D√©veloppement projets personnels, veille technologique, prototypage Unreal Engine et syst√®mes automatis√©s."},
                    {title: "Technicien Supervision R√©seau", company: "2024 ‚Ä¢ Rh√¥ne Telecom", description: "Supervision infrastructures r√©seau SFR, coordination √©quipes terrain, r√©solution incidents niveau 1-2."},
                    {title: "Consultant Wi-Fi & Support R√©seau", company: "2023 ‚Ä¢ Coll√®ge au Carr√©, Villeurbanne", description: "Diagnostic r√©seau Wi-Fi, configuration mat√©riel, documentation technique, formation utilisateurs."},
                    {title: "Co-g√©rant Commercial", company: "2021-2022 ‚Ä¢ Entreprise de vente", description: "Gestion commerciale march√©s/salons, sourcing international, coordination logistique, relation client."}
                ],
                education: [
                    {title: "Bachelor Cybers√©curit√©", period: "2023 ‚Ä¢ CSB School, Lyon", description: "Formation sp√©cialis√©e en s√©curit√© des syst√®mes et r√©seaux, d√©veloppement s√©curis√©."},
                    {title: "Formation Autodidacte", period: "2023-2025 ‚Ä¢ D√©veloppement Personnel", description: "Python, JavaScript, Unity, Unreal Engine, Linux - Projets GitHub, veille technologique active."},
                    {title: "DCG - Comptabilit√© Gestion", period: "2012 ‚Ä¢ Acad√©mie de Lyon", description: "Dipl√¥me de Comptabilit√© et Gestion - Base solide gestion administrative."}
                ],
                projects: [
                    {title: "Exp√©rimentation Game Dev", description: "Prototypes Unity/Unreal, exploration PCG, animation systems, level design.", icon: "fas fa-gamepad"},
                    {title: "Scripts d'Automatisation", description: "Outils Python personnels, gestion fichiers, APIs, workflow optimization.", icon: "fas fa-robot"},
                    {title: "Assemblage Hardware", description: "Montage PC custom, d√©pannage, optimisation performance, support technique.", icon: "fas fa-microchip"}
                ],
                international: [
                    {title: "Pays de Galles", period: "2019-2022", description: "Immersion culturelle compl√®te, perfectionnement anglais, adaptabilit√© internationale."},
                    {title: "Kyoto, Japon", period: "2015", description: "D√©couverte culture technologique japonaise, ouverture internationale."}
                ]
            },
            en: {
                jobTitle: "IT Technician & Junior Developer",
                age: "38 years old ‚Ä¢ Seeking stability and growth",
                contactTitle: "Contact",
                skillsTitle: "Technical Skills",
                programmingTitle: "Development",
                systemsTitle: "Systems & Network",
                gamedevTitle: "Game Dev",
                toolsTitle: "Tools",
                languagesTitle: "Languages",
                hobbiesTitle: "Hobbies",
                downloadPdf: "Download PDF",
                objectiveTitle: "Professional Objective",
                objectiveText: "Career transition into information technology. At 38, I'm seeking a stable environment to develop my self-taught technical skills and contribute effectively to concrete projects. My varied life experience and international openness are assets I want to put at the service of a dynamic team.",
                experienceTitle: "Professional Experience",
                educationTitle: "Education",
                projectsTitle: "Personal Projects",
                internationalTitle: "International Experience",
                portfolioTitle: "Video Portfolio",
                portfolioSubtitle: "My technical achievements in Game Development",
                scrollText: "View portfolio",
                quizTitle: "Tech Quest - Code Challenge",
                newQuestion: "New Question",
                hobby1Title: "Guitar",
                hobby1Desc:  "Musical passion, artistic creativity",
                hobby2Title: "Singing",
                hobby2Desc:  "Artistic expression, performance",
                hobby3Title: "Philosophy",
                hobby3Desc:  "Reflection, critical analysis",
                experiences: [
                    {title: "Freelance / Independent Worker", company: "2024 - Present ‚Ä¢ Tech Missions", description: "Personal project development, technology watch, Unreal Engine prototyping and automated systems."},
                    {title: "Network Supervision Technician", company: "2024 ‚Ä¢ Rh√¥ne Telecom", description: "SFR network infrastructure supervision, field team coordination, level 1-2 incident resolution."},
                    {title: "Wi-Fi Consultant & Network Support", company: "2023 ‚Ä¢ Coll√®ge au Carr√©, Villeurbanne", description: "Wi-Fi network diagnosis, hardware configuration, technical documentation, user training."},
                    {title: "Commercial Co-Manager", company: "2021-2022 ‚Ä¢ Sales Company", description: "Commercial management markets/trade shows, international sourcing, logistics coordination, customer relations."}
                ],
                education: [
                    {title: "Cybersecurity Bachelor", period: "2023 ‚Ä¢ CSB School, Lyon", description: "Specialized training in system and network security, secure development."},
                    {title: "Self-Taught Training", period: "2023-2025 ‚Ä¢ Personal Development", description: "Python, JavaScript, Unity, Unreal Engine, Linux - GitHub projects, active tech watch."},
                    {title: "DCG - Accounting Management", period: "2012 ‚Ä¢ Academy of Lyon", description: "Accounting and Management Diploma - Solid administrative management foundation."}
                ],
                projects: [
                    {title: "Game Dev Experimentation", description: "Unity/Unreal prototypes, PCG exploration, animation systems, level design.", icon: "fas fa-gamepad"},
                    {title: "Automation Scripts", description: "Personal Python tools, file management, APIs, workflow optimization.", icon: "fas fa-robot"},
                    {title: "Hardware Assembly", description: "Custom PC building, troubleshooting, performance optimization, technical support.", icon: "fas fa-microchip"}
                ],
                international: [
                    {title: "Wales", period: "2019-2022", description: "Complete cultural immersion, English improvement, international adaptability."},
                    {title: "Kyoto, Japan", period: "2015", description: "Discovery of Japanese technological culture, international openness."}
                ]
            }
        };

        // Skills Data
        const skillsData = {
            development: {
                'Python': {fr: "Langage polyvalent pour automatisation, APIs et analyse de donn√©es. Id√©al pour optimiser les processus m√©tier.", en: "Versatile language for automation, APIs and data analysis. Ideal for optimizing business processes."},
                'JavaScript': {fr: "D√©veloppement web moderne et interactif. Cr√©e des interfaces utilisateur engageantes et fonctionnelles.", en: "Modern and interactive web development. Creates engaging and functional user interfaces."},
                'C#': {fr: "D√©veloppement d'applications robustes et jeux vid√©o. Garantit performance et maintenabilit√© du code.", en: "Development of robust applications and video games. Ensures performance and code maintainability."},
                'HTML/CSS': {fr: "Cr√©ation de sites web responsive et modernes. Assure une exp√©rience utilisateur optimale sur tous supports.", en: "Creation of responsive and modern websites. Ensures optimal user experience on all devices."},
                'React.js': {fr: "Framework JavaScript pour interfaces dynamiques. Acc√©l√®re le d√©veloppement d'applications web complexes.", en: "JavaScript framework for dynamic interfaces. Accelerates complex web application development."},
                'Node.js': {fr: "D√©veloppement backend JavaScript haute performance. Permet une architecture full-stack coh√©rente.", en: "High-performance JavaScript backend development. Enables coherent full-stack architecture."},
                'Git/GitHub': {fr: "Gestion de versions collaborative professionnelle. Garantit tra√ßabilit√© et travail d'√©quipe efficace.", en: "Professional collaborative version control. Ensures traceability and efficient teamwork."},
                'VS Code': {fr: "Environnement de d√©veloppement optimis√©. Maximise la productivit√© avec extensions sp√©cialis√©es.", en: "Optimized development environment. Maximizes productivity with specialized extensions."},
                'APIs REST': {fr: "Int√©gration de services web modernes. Connecte applications pour √©change de donn√©es automatis√©.", en: "Modern web service integration. Connects applications for automated data exchange."}
            },
            gamedev: {
                'Unity': {fr: "Moteur de jeu professionnel 3D/2D. D√©veloppement rapide de prototypes et applications interactives.", en: "Professional 3D/2D game engine. Rapid development of prototypes and interactive applications."},
                'Unreal Engine': {fr: "Technologie cutting-edge pour exp√©riences immersives. Niveau AAA pour visualisation et simulation.", en: "Cutting-edge technology for immersive experiences. AAA level for visualization and simulation."},
                'Blender': {fr: "Cr√©ation de contenu 3D professionnel. Mod√©lisation, animation et rendu pour projets visuels.", en: "Professional 3D content creation. Modeling, animation and rendering for visual projects."},
                'PCG': {fr: "G√©n√©ration automatique de contenu proc√©dural. R√©duit drastiquement les co√ªts de production.", en: "Automatic procedural content generation. Drastically reduces production costs."},
                'Level Design': {fr: "Conception d'exp√©riences utilisateur engageantes. Optimise parcours et satisfaction utilisateur.", en: "Design of engaging user experiences. Optimizes user journey and satisfaction."},
                'Blueprint': {fr: "Programmation visuelle sans code traditionnel. Prototypage rapide et it√©ration design efficace.", en: "Visual programming without traditional code. Rapid prototyping and efficient design iteration."},
                'Motion Matching': {fr: "Animation proc√©durale ultra-r√©aliste. R√©volutionne l'interaction homme-machine naturelle.", en: "Ultra-realistic procedural animation. Revolutionizes natural human-machine interaction."}
            },
            systems: {
                'Linux': {fr: "Administration syst√®me professionelle. Gestion serveurs, automatisation et s√©curit√© optimis√©e.", en: "Professional system administration. Server management, automation and optimized security."},
                'Windows': {fr: "Support technique avanc√© et optimisation. R√©solution probl√®mes complexes environnement professionnel.", en: "Advanced technical support and optimization. Complex problem solving in professional environment."},
                'Hardware Assembly': {fr: "Montage et diagnostic mat√©riel expert. Optimisation performance et r√©duction co√ªts infrastructure.", en: "Expert hardware assembly and diagnostics. Performance optimization and infrastructure cost reduction."},
                'Networking': {fr: "Configuration r√©seaux entreprise VLAN/WAN. Garantit connectivit√© fiable et s√©curis√©e.", en: "Enterprise VLAN/WAN network configuration. Ensures reliable and secure connectivity."},
                'Troubleshooting': {fr: "Diagnostic m√©thodique et r√©solution rapide. Minimise downtime et maximise productivit√© √©quipes.", en: "Methodical diagnosis and rapid resolution. Minimizes downtime and maximizes team productivity."},
                'VM Management': {fr: "Virtualisation et isolation environnements. Optimise ressources et s√©curise d√©ploiements.", en: "Virtualization and environment isolation. Optimizes resources and secures deployments."},
                'Docker': {fr: "Conteneurisation pour d√©ploiement consistent. Garantit portabilit√© et scalabilit√© applications.", en: "Containerization for consistent deployment. Ensures application portability and scalability."}
            },
            tools: {
                'Cursor IDE': {fr: "Environnement de d√©veloppement IA int√©gr√©. Augmente productivit√© avec assistance intelligente.", en: "Integrated AI development environment. Increases productivity with intelligent assistance."},
                'Modern Workflow': {fr: "Outils d'automatisation cutting-edge. Optimise processus et acc√©l√®re time-to-market.", en: "Cutting-edge automation tools. Optimizes processes and accelerates time-to-market."},
                'Automation': {fr: "Scripts personnalis√©s gain de temps. √âlimine t√¢ches r√©p√©titives et erreurs humaines.", en: "Time-saving custom scripts. Eliminates repetitive tasks and human errors."},
                'Performance Optimization': {fr: "Analyse et am√©lioration vitesse applications. Garantit exp√©rience utilisateur fluide.", en: "Application speed analysis and improvement. Ensures smooth user experience."},
                'Documentation': {fr: "R√©daction technique claire et maintenue. Facilite collaboration et transfert de connaissances.", en: "Clear and maintained technical writing. Facilitates collaboration and knowledge transfer."}
            }
        };

        // Portfolio Videos
        const portfolioVideos = [
            {id: 'DulgCFivmik', title: {fr: 'üéÆ FPS Unreal Engine', en: 'üéÆ FPS Unreal Engine'}, description: {fr: 'Proof of concept style Call of Duty', en: 'Call of Duty style proof of concept'}, explanation: {fr: 'Prototype FPS - Syst√®me de gameplay complet avec level design tactique, m√©caniques de tir avanc√©es et interface utilisateur int√©gr√©e. Technologies: Unreal Engine 5, Blueprint, C++', en: 'FPS Prototype - Complete gameplay system with tactical level design, advanced shooting mechanics and integrated user interface. Technologies: Unreal Engine 5, Blueprint, C++'}},
            {id: 'YJgE9vukbUM', title: {fr: 'üèóÔ∏è Blockout Level Design', en: 'üèóÔ∏è Blockout Level Design'}, description: {fr: 'Demo blockout avec tests personnage', en: 'Blockout demo with character testing'}, explanation: {fr: 'Level Design - Processus de blockout complet, tests de gameplay et m√©caniques de saut, optimisation du player movement avec validation concepts.', en: 'Level Design - Complete blockout process, gameplay testing and jump mechanics, player movement optimization with concept validation.'}},
            {id: 'mncmCi8ENxE', title: {fr: 'üåç Plan√®te Proc√©durale PCG', en: 'üåç Procedural Planet PCG'}, description: {fr: 'G√©n√©ration plan√®te taille r√©elle UE5', en: 'Real-size planet generation UE5'}, explanation: {fr: 'Plan√®te Proc√©durale PCG - G√©n√©ration automatique plan√®te explorable taille r√©elle. Algorithmes proc√©duraux avanc√©s, optimisation LOD et streaming de contenu massif.', en: 'Procedural Planet PCG - Automatic generation of explorable real-size planet. Advanced procedural algorithms, LOD optimization and massive content streaming.'}},
            {id: 'o3Xi7jtjKeY', title: {fr: 'ü§ñ Motion Matching IA', en: 'ü§ñ AI Motion Matching'}, description: {fr: 'Animation fluide et moderne', en: 'Fluid and modern animation'}, explanation: {fr: 'Motion Matching IA - Syst√®me animation r√©volutionnaire avec transition automatique entre poses, IA pour s√©lection optimale et r√©activit√© temps r√©el aux inputs.', en: 'AI Motion Matching - Revolutionary animation system with automatic transition between poses, AI for optimal selection and real-time input responsiveness.'}},
            {id: 'vDkBvCrSWCA', title: {fr: 'üéÆ Plateformer 3D', en: 'üéÆ 3D Platformer'}, description: {fr: 'Jeu plateforme avec animation blending', en: 'Platform game with animation blending'}, explanation: {fr: 'Plateformer 3D - Jeu de plateforme avec animation blending fluide, character controller premium et m√©caniques de gameplay polies. Focus sur game feel et accessibilit√©.', en: '3D Platformer - Platform game with fluid animation blending, premium character controller and polished gameplay mechanics. Focus on game feel and accessibility.'}}
        ];

        // Color Themes
        const colorThemes = {
            classic: {name: 'Classic', primary: '#06b6d4', secondary: '#10b981', accent: '#8b5cf6', preview: 'linear-gradient(135deg, #06b6d4, #10b981)'},
            warm: {name: 'Warm', primary: '#f59e0b', secondary: '#ef4444', accent: '#f97316', preview: 'linear-gradient(135deg, #f59e0b, #ef4444)'},
            nature: {name: 'Nature', primary: '#10b981', secondary: '#059669', accent: '#047857', preview: 'linear-gradient(135deg, #10b981, #059669)'},
            purple: {name: 'Purple', primary: '#8b5cf6', secondary: '#a855f7', accent: '#7c3aed', preview: 'linear-gradient(135deg, #8b5cf6, #a855f7)'},
            monochrome: {name: 'Monochrome', primary: '#64748b', secondary: '#475569', accent: '#334155', preview: 'linear-gradient(135deg, #64748b, #475569)'},
            ocean: {name: 'Ocean', primary: '#0ea5e9', secondary: '#06b6d4', accent: '#0284c7', preview: 'linear-gradient(135deg, #0ea5e9, #06b6d4)'}
        };

        // Portrait Messages
        const portraitMessages = {
            fr: [
                "Je transforme le caf√© en code depuis 2023 !",
                "Mes bugs sont des features non document√©es üòè",
                "Level design IRL : j'optimise tout, m√™me ma routine caf√©",
                "Python et moi, c'est une histoire d'amour... compliqu√©e",
                "Je debug le hardware comme je debug le code : avec patience",
                "Unreal Engine m'a appris que les r√™ves peuvent √™tre proc√©duraux",
                "Mon GitHub, c'est mon jardin secret... mais public",
                "Entre Wales et Lyon, mon anglais a surv√©cu aux accents üè¥Û†ÅßÛ†Å¢Û†Å∑Û†Å¨Û†Å≥Û†Åø",
                "Je fais du Blender sans mixeur, √ßa vous √©pate ?",
                "38 ans, reconversion assum√©e, passion intacte !",
                "Mes algorithmes de pathfinding marchent mieux que mon GPS üó∫Ô∏è",
                "Je code en C++ mais je r√™ve en Blueprint",
                "Stack Overflow est mon meilleur ami... et parfois mon pire ennemi",
                "Je collecte les erreurs de compilation comme d'autres les timbres",
                "Mon IDE pr√©f√©r√© ? Celui qui ne crash pas le lundi matin ‚òï",
                "Je pense que les gens normaux n'ont pas 47 onglets ouverts",
                "Entre deux lignes de code, je mod√©lise des mondes en 3D",
                "Ma d√©finition du multit√¢che : compiler en regardant YouTube",
                "Je traduis '√ßa marche sur ma machine' en anglais couramment",
                "Les r√©unions sont mes boss fights les plus difficiles üéÆ"
            ],
            en: [
                "I've been turning coffee into code since 2023!",
                "My bugs are undocumented features üòè",
                "Level design IRL: I optimize everything, even my coffee routine",
                "Python and I have a complicated love story",
                "I debug hardware like I debug code: with patience",
                "Unreal Engine taught me that dreams can be procedural",
                "My GitHub is my secret garden... but public",
                "Between Wales and Lyon, my English survived the accents üè¥Û†ÅßÛ†Å¢Û†Å∑Û†Å¨Û†Å≥Û†Åø",
                "I do Blender without a blender, impressed?",
                "38 years old, career change assumed, passion intact!",
                "My pathfinding algorithms work better than my GPS üó∫Ô∏è",
                "I code in C++ but dream in Blueprint",
                "Stack Overflow is my best friend... and sometimes my worst enemy",
                "I collect compilation errors like others collect stamps",
                "My favorite IDE? The one that doesn't crash on Monday morning ‚òï",
                "I think normal people don't have 47 tabs open",
                "Between two lines of code, I model 3D worlds",
                "My definition of multitasking: compiling while watching YouTube",
                "I fluently translate 'it works on my machine' into English",
                "Meetings are my most difficult boss fights üéÆ"
            ]
        };

        // Quiz Puzzles
        const puzzles = {
            fr: [
                {
                    question: "Que va afficher ce code ?\n\nconsole.log(typeof null);",
                    options: ["null", "object", "undefined", "error"],
                    correct: 1,
                    explanation: "En JavaScript, typeof null retourne 'object' - c'est un bug historique du langage !"
                },
                {
                    question: "Quelle est la diff√©rence entre == et === ?",
                    options: ["Aucune diff√©rence", "=== compare type et valeur", "== est plus rapide", "=== accepte null"],
                    correct: 1,
                    explanation: "=== compare √† la fois le type et la valeur, tandis que == fait une conversion de type automatique."
                },
                {
                    question: "Que fait ce code ?\n\nlet arr = [1,2,3];\narr.length = 0;",
                    options: ["Erreur", "Vide le tableau", "Supprime length", "Rien"],
                    correct: 1,
                    explanation: "Assigner 0 √† la propri√©t√© length vide compl√®tement le tableau en JavaScript."
                },
                {
                    question: "Quel est le r√©sultat ?\n\n'5' + 3 - 1",
                    options: ["7", "52", "53 - 1", "NaN"],
                    correct: 1,
                    explanation: "'5' + 3 donne '53' (concat√©nation), puis '53' - 1 donne 52 (conversion en nombre)."
                }
            ],
            en: [
                {
                    question: "What will this code output?\n\nconsole.log(typeof null);",
                    options: ["null", "object", "undefined", "error"],
                    correct: 1,
                    explanation: "In JavaScript, typeof null returns 'object' - this is a historical bug in the language!"
                },
                {
                    question: "What's the difference between == and === ?",
                    options: ["No difference", "=== compares type and value", "== is faster", "=== accepts null"],
                    correct: 1,
                    explanation: "=== compares both type and value, while == performs automatic type conversion."
                },
                {
                    question: "What does this code do?\n\nlet arr = [1,2,3];\narr.length = 0;",
                    options: ["Error", "Empties the array", "Removes length", "Nothing"],
                    correct: 1,
                    explanation: "Setting length to 0 completely empties the array in JavaScript."
                },
                {
                    question: "What's the result?\n\n'5' + 3 - 1",
                    options: ["7", "52", "53 - 1", "NaN"],
                    correct: 1,
                    explanation: "'5' + 3 gives '53' (concatenation), then '53' - 1 gives 52 (number conversion)."
                }
            ]
        };

        let currentPuzzle = 0;

        // Typewriter Class
        class TypewriterEffect {
            constructor(element, text, options = {}) {
                this.element = element;
                this.text = text;
                this.speed = options.speed || 50;
                this.currentIndex = 0;
                this.isTyping = false;
                this.showCursor = options.showCursor !== false;
                this.isStopped = false;
                this.dialogue = options.dialogue; // Reference to the dialogue container
            }

            type() {
                if (this.isTyping || this.isStopped) return;
                this.isTyping = true;
                this.element.innerHTML = '';
                this.currentIndex = 0;
                
                if (this.showCursor) {
                    this.element.innerHTML = '<span class="typewriter-cursor">|</span>';
                }
                
                this.typeNextChar();
            }

            typeNextChar() {
                if (this.currentIndex >= this.text.length || this.isStopped) {
                    this.isTyping = false;
                    if (this.showCursor && !this.isStopped) {
                        setTimeout(() => {
                            const cursor = this.element.querySelector('.typewriter-cursor');
                            if (cursor) cursor.style.opacity = '0';
                        }, 1000);
                    }
                    return;
                }

                const char = this.text[this.currentIndex];
                const cursor = this.element.querySelector('.typewriter-cursor');
                
                if (cursor) {
                    cursor.insertAdjacentText('beforebegin', char);
                } else {
                    this.element.textContent += char;
                }

                // Adjust dialogue position as it grows (for portrait dialogue)
                if (this.dialogue && this.dialogue.id === 'portraitDialogue') {
                    this.adjustDialoguePosition();
                }

                this.currentIndex++;
                let delay = this.speed;
                
                if ('.,!?;:'.includes(char)) {
                    delay = this.speed * 3;
                } else if (char === ' ') {
                    delay = this.speed * 1.5;
                } else {
                    delay = this.speed + (Math.random() * 30 - 15);
                }

                setTimeout(() => this.typeNextChar(), Math.max(20, delay));
            }

            adjustDialoguePosition() {
                if (!this.dialogue || !this.dialogue.dataset.arrowClass) return;
                
                const rect = this.dialogue.getBoundingClientRect();
                const initialTop = parseFloat(this.dialogue.dataset.initialTop);
                const initialLeft = parseFloat(this.dialogue.dataset.initialLeft);
                const arrowClass = this.dialogue.dataset.arrowClass;
                
                // Only adjust for vertical growth (when arrow is top or bottom)
                if (arrowClass === 'arrow-bottom') {
                    // Dialogue is above the image, adjust upward as it grows
                    const currentHeight = rect.height;
                    const estimatedInitialHeight = 60; // rough estimate for small bubble
                    const heightDiff = currentHeight - estimatedInitialHeight;
                    
                    if (heightDiff > 0) {
                        this.dialogue.style.top = (initialTop - heightDiff) + 'px';
                    }
                } else if (arrowClass === 'arrow-top') {
                    // Dialogue is below the image, position stays the same (grows downward naturally)
                    this.dialogue.style.top = initialTop + 'px';
                }
                
                // Keep horizontal position consistent
                this.dialogue.style.left = initialLeft + 'px';
            }

            stop() {
                this.isStopped = true;
                this.isTyping = false;
                this.currentIndex = 0;
            }
        }

        // Particle System
        class AdvancedParticleSystem {
            constructor(canvas) {
                this.canvas = canvas;
                this.ctx = canvas.getContext('2d');
                this.particles = [];
                this.settings = JSON.parse(localStorage.getItem('particle-settings') || '{"type":"circle","movement":"float","intensity":50,"speed":"normal","size":"small","opacity":"subtle"}');
                this.setupCanvas();
                this.createParticles();
                this.animate();
            }

            setupCanvas() {
                this.canvas.width = window.innerWidth;
                this.canvas.height = window.innerHeight;
            }

            getSpeedMultiplier() {
                const speeds = {slow: 0.3, normal: 0.6, fast: 1.2, ultra: 2.0};
                return speeds[this.settings.speed] || 0.6;
            }

            getSizeRange() {
                const sizes = {micro: [0.5, 1.5], small: [1, 3], medium: [2, 5], large: [3, 8]};
                return sizes[this.settings.size] || [1, 3];
            }

            getOpacityRange() {
                const opacities = {subtle: [0.05, 0.15], visible: [0.1, 0.3], intense: [0.2, 0.5]};
                return opacities[this.settings.opacity] || [0.05, 0.15];
            }

            createParticle() {
                const [minSize, maxSize] = this.getSizeRange();
                const [minOpacity, maxOpacity] = this.getOpacityRange();
                const speedMult = this.getSpeedMultiplier();

                return {
                    x: Math.random() * this.canvas.width,
                    y: Math.random() * this.canvas.height,
                    vx: (Math.random() - 0.5) * speedMult,
                    vy: (Math.random() - 0.5) * speedMult,
                    size: Math.random() * (maxSize - minSize) + minSize,
                    opacity: Math.random() * (maxOpacity - minOpacity) + minOpacity,
                    angle: Math.random() * Math.PI * 2,
                    angleSpeed: (Math.random() - 0.5) * 0.02,
                    color: this.getRandomColor(),
                    life: Math.random() * 1000,
                    maxLife: 1000
                };
            }

            getRandomColor() {
                const colors = [
                    `rgba(${this.hexToRgb(currentTheme.primary)}, ${this.getOpacityRange()[1]})`,
                    `rgba(${this.hexToRgb(currentTheme.secondary)}, ${this.getOpacityRange()[0] * 1.5})`,
                    `rgba(${this.hexToRgb(currentTheme.accent)}, ${this.getOpacityRange()[0]})`
                ];
                return colors[Math.floor(Math.random() * colors.length)];
            }

            hexToRgb(hex) {
                const result = /^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(hex);
                return result ?
                    `${parseInt(result[1], 16)}, ${parseInt(result[2], 16)}, ${parseInt(result[3], 16)}` :
                    '6, 182, 212';
            }

            createParticles() {
                this.particles = [];
                for (let i = 0; i < this.settings.intensity; i++) {
                    this.particles.push(this.createParticle());
                }
            }

            updateParticle(particle) {
                const speedMult = this.getSpeedMultiplier();

                switch (this.settings.movement) {
                    case 'float':
                        particle.x += particle.vx;
                        particle.y += particle.vy;
                        break;
                    case 'spiral':
                        particle.angle += particle.angleSpeed * speedMult;
                        particle.x += Math.cos(particle.angle) * 2 * speedMult;
                        particle.y += Math.sin(particle.angle) * 2 * speedMult;
                        break;
                    case 'wave':
                        particle.x += particle.vx;
                        particle.y += particle.vy + Math.sin(particle.x * 0.01) * 0.5 * speedMult;
                        break;
                    case 'magnetic':
                        const centerX = this.canvas.width / 2;
                        const centerY = this.canvas.height / 2;
                        const dx = centerX - particle.x;
                        const dy = centerY - particle.y;
                        const dist = Math.sqrt(dx * dx + dy * dy);
                        particle.x += (dx / dist) * 0.1 * speedMult;
                        particle.y += (dy / dist) * 0.1 * speedMult;
                        break;
                    case 'orbital':
                        const orbitalCenterX = this.canvas.width / 2;
                        const orbitalCenterY = this.canvas.height / 2;
                        particle.angle += 0.01 * speedMult;
                        const radius = 200 + Math.sin(particle.life * 0.01) * 50;
                        particle.x = orbitalCenterX + Math.cos(particle.angle) * radius;
                        particle.y = orbitalCenterY + Math.sin(particle.angle) * radius;
                        break;
                }

                if (particle.x < 0) particle.x = this.canvas.width;
                if (particle.x > this.canvas.width) particle.x = 0;
                if (particle.y < 0) particle.y = this.canvas.height;
                if (particle.y > this.canvas.height) particle.y = 0;

                particle.life++;
                if (particle.life > particle.maxLife) {
                    Object.assign(particle, this.createParticle());
                }
            }

            drawParticle(particle) {
                this.ctx.save();
                this.ctx.globalAlpha = particle.opacity;
                this.ctx.fillStyle = particle.color;

                switch (this.settings.type) {
                    case 'circle':
                        this.ctx.beginPath();
                        this.ctx.arc(particle.x, particle.y, particle.size, 0, Math.PI * 2);
                        this.ctx.fill();
                        break;
                    case 'star':
                        this.drawStar(particle.x, particle.y, particle.size);
                        break;
                    case 'triangle':
                        this.drawTriangle(particle.x, particle.y, particle.size);
                        break;
                    case 'line':
                        this.ctx.beginPath();
                        this.ctx.moveTo(particle.x, particle.y);
                        this.ctx.lineTo(particle.x + particle.size * 3, particle.y);
                        this.ctx.strokeStyle = particle.color;
                        this.ctx.lineWidth = particle.size;
                        this.ctx.stroke();
                        break;
                    case 'pixel':
                        this.ctx.fillRect(particle.x, particle.y, particle.size, particle.size);
                        break;
                }
                this.ctx.restore();
            }

            drawStar(x, y, size) {
                this.ctx.beginPath();
                for (let i = 0; i < 5; i++) {
                    const angle = (i * 4 * Math.PI) / 5;
                    const x1 = x + Math.cos(angle) * size;
                    const y1 = y + Math.sin(angle) * size;
                    if (i === 0) this.ctx.moveTo(x1, y1);
                    else this.ctx.lineTo(x1, y1);
                }
                this.ctx.closePath();
                this.ctx.fill();
            }

            drawTriangle(x, y, size) {
                this.ctx.beginPath();
                this.ctx.moveTo(x, y - size);
                this.ctx.lineTo(x - size, y + size);
                this.ctx.lineTo(x + size, y + size);
                this.ctx.closePath();
                this.ctx.fill();
            }

            animate() {
                this.ctx.clearRect(0, 0, this.canvas.width, this.canvas.height);
                this.particles.forEach(particle => {
                    this.updateParticle(particle);
                    this.drawParticle(particle);
                });
                requestAnimationFrame(() => this.animate());
            }

            updateSettings(newSettings) {
                Object.assign(this.settings, newSettings);
                this.createParticles();
                localStorage.setItem('particle-settings', JSON.stringify(this.settings));
            }

            resize() {
                this.setupCanvas();
            }

            toggle() {
                if (this.particles.length === 0) {
                    this.createParticles();
                } else {
                    this.particles = [];
                }
            }
        }

        // Initialize Functions
        function initializeCV() {
            applyTheme(currentTheme);
            const canvas = document.getElementById('particleCanvas');
            particleSystem = new AdvancedParticleSystem(canvas);
            document.querySelector(`[data-lang-key="${currentLang}"]`).classList.add('active');
            updateContent();
            initializeColorThemes();
            setupEventListeners();
            setupScrollIndicator();
            updateGamingMode();
            updateGameDisplay();
            updateTamaIcon();
            loadHudSettings(); // Charger les param√®tres du HUD
            loadHudPositions(); // Charger les positions du HUD
            
            // Initialize gaming unlock state
            if (gamingUnlocked) {
                unlockGamingMode();
            }

            // Setup gaming toggle hover events
            const gameToggle = document.getElementById('gameToggle');
            gameToggle.addEventListener('mouseenter', function() {
                if (gamingUnlocked) {
                    const text = this.getAttribute('data-text') || 'Gaming';
                    this.innerHTML = `üéÆ ${text}`;
                }
            });
            
            gameToggle.addEventListener('mouseleave', function() {
                if (gamingUnlocked) {
                    this.innerHTML = 'üéÆ';
                }
            });

            // Show welcome message after everything is loaded
            showWelcomeMessage();
        }

        function setupEventListeners() {
            window.addEventListener('resize', () => {
                if (particleSystem) particleSystem.resize();
            });

            document.addEventListener('keydown', (e) => {
                if (e.key === 'Escape') {
                    closeColorPicker();
                    closeTheater();
                    closeMiniGame();
                }
                if (e.key.toLowerCase() === 'c' && !document.getElementById('colorPickerOverlay').classList.contains('active')) {
                    openColorPicker();
                }
                if (e.key.toLowerCase() === 'p') {
                    if (particleSystem) particleSystem.toggle();
                }
            });

            // Skill tooltips with debounce
            let tooltipTimeout;
            document.addEventListener('mouseenter', (e) => {
                if (e.target && e.target.classList && e.target.classList.contains('skill-bubble')) {
                    clearTimeout(tooltipTimeout);
                    clearTimeout(e.target.hideTimeout);
                    showSkillTooltip(e.target);
                }
            }, true);

            document.addEventListener('mouseleave', (e) => {
                if (e.target && e.target.classList && e.target.classList.contains('skill-bubble')) {
                    e.target.hideTimeout = setTimeout(() => {
                        hideSkillTooltip(e.target);
                    }, 150);
                }
            }, true);
        }

        function setupScrollIndicator() {
            window.addEventListener('scroll', () => {
                const portfolioSection = document.querySelector('.portfolio-section');
                const rect = portfolioSection.getBoundingClientRect();
                const indicator = document.getElementById('scrollIndicator');
                
                if (rect.top <= window.innerHeight * 0.8) {
                    indicator.style.opacity = '0';
                    indicator.style.pointerEvents = 'none';
                } else {
                    indicator.style.opacity = '1';
                    indicator.style.pointerEvents = 'auto';
                }
            });
        }

        function showSkillTooltip(skillElement) {
            const tooltip = skillElement.querySelector('.skill-tooltip');
            if (!tooltip) return;

            const key = skillElement.textContent.trim();
            
            // Track skill exploration for achievements
            if (gamingMode) {
                trackSkillHover(key);
            }
            
            // Stop any existing typewriter for this skill
            if (typewriterInstances.has(key)) {
                typewriterInstances.get(key).stop();
                typewriterInstances.delete(key);
            }

            // Clear and reset tooltip
           // tooltip.textContent = '';
            
            // Position tooltip
            const rect = skillElement.getBoundingClientRect();
            if (rect.left + 280 > window.innerWidth) {
                tooltip.style.left = 'auto';
                tooltip.style.right = '0';
                tooltip.style.transform = 'translateX(0)';
            } else if (rect.left - 140 < 0) {
                tooltip.style.left = '0';
                tooltip.style.right = 'auto';
                tooltip.style.transform = 'translateX(0)';
            } else {
                tooltip.style.left = '50%';
                tooltip.style.right = 'auto';
                tooltip.style.transform = 'translateX(-50%)';
            }

            tooltip.classList.add('show');

            // Get skill data and start typewriter
            const skillData = getSkillData(key);
            if (skillData) {
                setTimeout(() => {
                    const typewriter = new TypewriterEffect(tooltip, skillData[currentLang], {
                        speed: 25,
                        showCursor: false
                    });
                    typewriterInstances.set(key, typewriter);
                    typewriter.type();
                }, 0);
            }

            if (gamingMode) {
                triggerAction('skill-hover');
            }
        }

        function hideSkillTooltip(skillElement) {
            const tooltip = skillElement.querySelector('.skill-tooltip');
            if (!tooltip) return;

            const key = skillElement.textContent.trim();
            if (typewriterInstances.has(key)) {
                typewriterInstances.get(key).stop();
                typewriterInstances.delete(key);
            }

            tooltip.classList.remove('show');
            tooltip.textContent = '';
        }

        function getSkillData(skillName) {
            for (const [category, skills] of Object.entries(skillsData)) {
                if (skills[skillName]) return skills[skillName];
            }
            return null;
        }

        function switchLanguage(lang) {
            // Don't process if it's the same language
            if (currentLang === lang) return;
            
            const previousLang = currentLang;
            currentLang = lang;
            localStorage.setItem('preferredLanguage', lang);
            
            document.querySelectorAll('.lang-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            document.querySelector(`[data-lang-key="${lang}"]`).classList.add('active');
            
            document.documentElement.lang = lang;
            updateContent();
            
            // Handle language switch message
            handleLanguageSwitch(lang);
        }

        function updateContent() {
            const t = translations[currentLang];
            
            document.querySelectorAll('[data-lang]').forEach(el => {
                const key = el.getAttribute('data-lang');
                if (t[key]) {
                    el.textContent = t[key];
                }
            });
            
            const downloadLink = document.getElementById('downloadLink');
            if (currentLang === 'fr') {
                downloadLink.href = 'https://drive.google.com/uc?export=download&id=1m2gYO3lF9H9zKT0QXNhMc-ugcgWkHnD0';
            } else {
                downloadLink.href = 'https://drive.google.com/uc?export=download&id=1yTQXDdlkjcYsX4RUXXIh9Wzwld-OXJaE';
            }
            
            updateExperience();
            updateEducation();
            updateProjects();
            updateInternational();
            updateSkills();
            updateLanguages();
            updatePortfolio();
        }

        function updateExperience() {
            const container = document.getElementById('experienceContent');
            const experiences = translations[currentLang].experiences;
            
            container.innerHTML = experiences.map(exp => `
                <div class="experience-item">
                    <h4 class="text-white font-medium text-sm mb-1">${exp.title}</h4>
                    <p class="text-blue-400 text-xs mb-2 font-medium">${exp.company}</p>
                    <p class="text-gray-300 text-xs leading-relaxed">${exp.description}</p>
                </div>
            `).join('');
        }

        function updateEducation() {
            const container = document.getElementById('educationContent');
            const education = translations[currentLang].education;
            
            container.innerHTML = education.map(edu => `
                <div class="experience-item">
                    <h4 class="text-white font-medium text-sm mb-1">${edu.title}</h4>
                    <p class="text-green-400 text-xs mb-2 font-medium">${edu.period}</p>
                    <p class="text-gray-300 text-xs leading-relaxed">${edu.description}</p>
                </div>
            `).join('');
        }

        function updateProjects() {
            const container = document.getElementById('projectsContent');
            const projects = translations[currentLang].projects;
            
            container.innerHTML = projects.map(project => `
                <div class="flex items-start gap-3 p-3 bg-gray-800 bg-opacity-20 rounded-lg">
                    <i class="${project.icon} text-blue-400 mt-1"></i>
                    <div>
                        <h4 class="text-white font-medium text-sm mb-1">${project.title}</h4>
                        <p class="text-gray-300 text-xs leading-relaxed">${project.description}</p>
                    </div>
                </div>
            `).join('');
        }

        function updateInternational() {
            const container = document.getElementById('internationalContent');
            const international = translations[currentLang].international;
            
            container.innerHTML = international.map(exp => `
                <div class="experience-item">
                    <h4 class="text-white font-medium text-sm mb-1">${exp.title}</h4>
                    <p class="text-blue-400 text-xs mb-2 font-medium">${exp.period}</p>
                    <p class="text-gray-300 text-xs leading-relaxed">${exp.description}</p>
                </div>
            `).join('');
        }

        function updateSkills() {
            const categories = ['development', 'gamedev', 'systems', 'tools'];
            
            categories.forEach(category => {
                const container = document.getElementById(`${category}Skills`);
                if (container) {
                    const skills = Object.keys(skillsData[category]);
                    container.innerHTML = skills.map(skill => {
                        const tooltip = skillsData[category][skill][currentLang];
                        return `
                            <span class="skill-bubble">
                                ${skill}
                                <div class="skill-tooltip">${tooltip}</div>
                            </span>
                        `;
                    }).join('');
                }
            });
        }

        function updateLanguages() {
            const container = document.getElementById('languagesContent');
            
            const languages = [
                {name: currentLang === 'fr' ? 'Fran√ßais' : 'French', level: currentLang === 'fr' ? 'C2 (Natif)' : 'C2 (Native)', progress: 100},
                {name: currentLang === 'fr' ? 'Anglais' : 'English', level: currentLang === 'fr' ? 'C1 (Courant)' : 'C1 (Fluent)', progress: 85}
            ];

            container.innerHTML = languages.map(lang => `
                <div class="language-item">
                    <div class="flex items-center gap-3">
                        <span class="text-white font-medium">${lang.name}</span>
                        <span class="cecrl-badge">${lang.level}</span>
                    </div>
                    <div class="level-progress">
                        <div class="level-fill" style="width: ${lang.progress}%"></div>
                    </div>
                </div>
            `).join('');
        }

        function updatePortfolio() {
            const container = document.getElementById('portfolioGrid');
            
            container.innerHTML = portfolioVideos.map((video, index) => `
                <div class="portfolio-card" onclick="showTheaterOverlay(${index})" data-index="${index}">
                    <div class="video-thumbnail">
                        <img src="https://img.youtube.com/vi/${video.id}/hqdefault.jpg" 
                            alt="${video.title[currentLang]}" 
                            style="width: 100%; height: 100%; object-fit: cover;">
                    </div>
                    <div class="video-description">
                        <h4 class="text-xl font-bold text-white mb-2">${video.title[currentLang]}</h4>
                        <p class="text-gray-300 text-sm">${video.description[currentLang]}</p>
                        <div class="flex flex-wrap gap-2 mt-3">
                            <span class="tech-tag">Unreal Engine</span>
                            <span class="tech-tag">Blueprint</span>
                            <span class="tech-tag">Level Design</span>
                        </div>
                    </div>
                </div>
            `).join('');
        }


        // Theater Functions
        function showTheaterOverlay(index) {
            const overlay = document.getElementById('theaterOverlay');
            const video = document.getElementById('theaterVideo');
            const explanation = document.getElementById('videoExplanation');
            
            const videoData = portfolioVideos[index];
            if (!videoData) return;
            
            // Track video watch for achievements
            if (gamingMode) {
                trackVideoWatch(videoData.id);
            }
            
            overlay.classList.add('active');
            video.src = `https://www.youtube.com/embed/${videoData.id}?autoplay=1&mute=1`;
            
            setTimeout(() => {
                const typewriter = new TypewriterEffect(explanation, videoData.explanation[currentLang], {speed: 40, variableSpeed: true});
                typewriter.type();
            }, 800);

            if (gamingMode) {
                triggerAction('video-theater');
            }
        }

        function closeTheater(event) {
            if (event && event.target !== event.currentTarget && !event.target.classList.contains('close-theater')) return;
            
            const overlay = document.getElementById('theaterOverlay');
            const video = document.getElementById('theaterVideo');
            
            overlay.classList.remove('active');
            video.src = '';
        }

        function slideCarousel(direction) {
            const grid = document.getElementById('portfolioGrid');
            const cardWidth = 350 + 16; // card width + gap
            const maxScroll = grid.scrollWidth - grid.clientWidth;
            const currentScroll = grid.scrollLeft;
            
            let newScroll = currentScroll + (direction * cardWidth);
            
            if (newScroll < 0) newScroll = 0;
            if (newScroll > maxScroll) newScroll = maxScroll;
            
            grid.scrollTo({left: newScroll, behavior: 'smooth'});
        }

        // Color Picker Functions
        function openColorPicker() {
            document.getElementById('colorPickerOverlay').classList.add('active');
            if (gamingMode) {
                triggerAction('customization');
            }
        }

        function closeColorPicker(event) {
            if (event && event.target !== event.currentTarget && !event.target.classList.contains('close-theater')) return;
            document.getElementById('colorPickerOverlay').classList.remove('active');
            
            // Arr√™ter la pr√©visualisation HUD si elle est active
            if (hudPreviewActive) {
                toggleHudPreview();
            }
        }

        function switchTab(tabName) {
            document.querySelectorAll('.tab-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            document.querySelector(`[onclick="switchTab('${tabName}')"]`).classList.add('active');
            
            document.querySelectorAll('.tab-content').forEach(content => {
                content.classList.remove('active');
            });
            document.getElementById(`${tabName}Tab`).classList.add('active');
        }

        function initializeColorThemes() {
            const container = document.getElementById('themeGrid');
            
            container.innerHTML = Object.entries(colorThemes).map(([key, theme]) => `
                <div class="theme-preview ${key === currentTheme.name.toLowerCase() ? 'active' : ''}" 
                     style="background: ${theme.preview}" 
                     onclick="applyTheme(colorThemes.${key})"
                     title="${theme.name}">
                </div>
            `).join('');
        }

        function applyTheme(theme) {
            currentTheme = theme;
            const root = document.documentElement;
            
            const primaryRgb = hexToRgb(theme.primary);
            const secondaryRgb = hexToRgb(theme.secondary);
            
            root.style.setProperty('--primary', theme.primary);
            root.style.setProperty('--secondary', theme.secondary);
            root.style.setProperty('--accent', theme.accent);
            root.style.setProperty('--primary-rgb', primaryRgb);
            root.style.setProperty('--secondary-rgb', secondaryRgb);
            
            if (particleSystem) {
                particleSystem.createParticles();
            }
            
            document.querySelectorAll('.theme-preview').forEach(preview => {
                preview.classList.remove('active');
            });
            
            localStorage.setItem('cv-theme', JSON.stringify(theme));
            
            // Theme change achievement
            if (gamingMode) {
                unlockAchievement('theme_changer');
            }
        }

        function updateCustomColors() {
            const primary = document.getElementById('primaryColor').value;
            const secondary = document.getElementById('secondaryColor').value;
            
            const customTheme = {
                name: 'Custom',
                primary: primary,
                secondary: secondary,
                accent: primary
            };
            
            applyTheme(customTheme);
        }

        function updateHudStyles() {
            const hudBgColor = document.getElementById('hudBgColor').value;
            const hudOpacity = document.getElementById('hudOpacity').value;
            const hudBgOpacity = document.getElementById('hudBgOpacity').value;
            
            // Mettre √† jour les affichages des valeurs
            document.getElementById('hudOpacityValue').textContent = hudOpacity + '%';
            document.getElementById('hudBgOpacityValue').textContent = hudBgOpacity + '%';
            
            // Convertir la couleur hex en rgba
            const rgbColor = hexToRgb(hudBgColor);
            const bgOpacityDecimal = hudBgOpacity / 100;
            const hudOpacityDecimal = hudOpacity / 100;
            
            // Appliquer les styles CSS
            document.documentElement.style.setProperty('--hud-bg', `rgba(${rgbColor}, ${bgOpacityDecimal})`);
            document.documentElement.style.setProperty('--hud-opacity', hudOpacityDecimal);
            
            // Sauvegarder les pr√©f√©rences
            const hudSettings = {
                bgColor: hudBgColor,
                opacity: hudOpacity,
                bgOpacity: hudBgOpacity
            };
            localStorage.setItem('hud-settings', JSON.stringify(hudSettings));
        }

        function resetHudStyles() {
            // Remettre les valeurs par d√©faut
            document.getElementById('hudBgColor').value = '#0f172a';
            document.getElementById('hudOpacity').value = '90';
            document.getElementById('hudBgOpacity').value = '90';
            
            // Appliquer les valeurs par d√©faut
            updateHudStyles();
        }

        function loadHudSettings() {
            const savedSettings = localStorage.getItem('hud-settings');
            if (savedSettings) {
                const settings = JSON.parse(savedSettings);
                document.getElementById('hudBgColor').value = settings.bgColor || '#0f172a';
                document.getElementById('hudOpacity').value = settings.opacity || '90';
                document.getElementById('hudBgOpacity').value = settings.bgOpacity || '90';
                updateHudStyles();
            }
        }

        function updateHudPositions() {
            const ericBottom = document.getElementById('ericBottom').value;
            const ericRight = document.getElementById('ericRight').value;
            const ericSize = document.getElementById('ericSize').value;
            const hudBottom = document.getElementById('hudBottom').value;
            const hudRight = document.getElementById('hudRight').value;
            const hudScale = document.getElementById('hudScale').value;
            const notifBottom = document.getElementById('notifBottom').value;
            const notifRight = document.getElementById('notifRight').value;
            const achievBottom = document.getElementById('achievBottom').value;
            const achievRight = document.getElementById('achievRight').value;

            // Mettre √† jour les affichages des valeurs
            document.getElementById('ericBottomValue').textContent = ericBottom + 'rem';
            document.getElementById('ericRightValue').textContent = ericRight + 'rem';
            document.getElementById('ericSizeValue').textContent = ericSize + 'px';
            document.getElementById('hudBottomValue').textContent = hudBottom + 'rem';
            document.getElementById('hudRightValue').textContent = hudRight + 'rem';
            document.getElementById('hudScaleValue').textContent = hudScale + '%';
            document.getElementById('notifBottomValue').textContent = notifBottom + 'rem';
            document.getElementById('notifRightValue').textContent = notifRight + 'rem';
            document.getElementById('achievBottomValue').textContent = achievBottom + 'rem';
            document.getElementById('achievRightValue').textContent = achievRight + 'rem';

            // Appliquer les positions CSS via variables CSS
            document.documentElement.style.setProperty('--eric-bottom', ericBottom + 'rem');
            document.documentElement.style.setProperty('--eric-right', ericRight + 'rem');
            document.documentElement.style.setProperty('--eric-size', ericSize + 'px');
            document.documentElement.style.setProperty('--hud-bottom', hudBottom + 'rem');
            document.documentElement.style.setProperty('--hud-right', hudRight + 'rem');
            document.documentElement.style.setProperty('--hud-scale', hudScale / 100);
            document.documentElement.style.setProperty('--notif-bottom', notifBottom + 'rem');
            document.documentElement.style.setProperty('--notif-right', notifRight + 'rem');
            document.documentElement.style.setProperty('--achiev-bottom', achievBottom + 'rem');
            document.documentElement.style.setProperty('--achiev-right', achievRight + 'rem');

            // Appliquer les positions CSS directement (fallback)
            const tamagotchi = document.getElementById('tamagotchi');
            const gamingController = document.getElementById('gamingController');
            const gameHUD = document.getElementById('gameHUD');
            const gameNotification = document.getElementById('gameNotification');
            const achievementToast = document.getElementById('achievementToast');

            if (tamagotchi) {
                tamagotchi.style.bottom = ericBottom + 'rem';
                tamagotchi.style.right = ericRight + 'rem';
                tamagotchi.style.width = ericSize + 'px';
                tamagotchi.style.height = ericSize + 'px';
            }

            if (gamingController) {
                gamingController.style.bottom = ericBottom + 'rem';
                gamingController.style.right = ericRight + 'rem';
                gamingController.style.width = ericSize + 'px';
                gamingController.style.height = ericSize + 'px';
            }

            if (gameHUD) {
                gameHUD.style.bottom = hudBottom + 'rem';
                gameHUD.style.right = hudRight + 'rem';
                gameHUD.style.transform = `scale(${hudScale / 100})`;
                gameHUD.style.transformOrigin = 'bottom right';
            }

            if (gameNotification) {
                gameNotification.style.bottom = notifBottom + 'rem';
                gameNotification.style.right = notifRight + 'rem';
            }

            if (achievementToast) {
                achievementToast.style.bottom = achievBottom + 'rem';
                achievementToast.style.right = achievRight + 'rem';
            }

            // Sauvegarder les positions
            const positionSettings = {
                ericBottom, ericRight, ericSize,
                hudBottom, hudRight, hudScale,
                notifBottom, notifRight, achievBottom, achievRight
            };
            localStorage.setItem('hud-positions', JSON.stringify(positionSettings));
        }

        function resetHudPositions() {
            // Remettre les valeurs par d√©faut
            document.getElementById('ericBottom').value = '3.5';
            document.getElementById('ericRight').value = '2';
            document.getElementById('ericSize').value = '88';
            document.getElementById('hudBottom').value = '5';
            document.getElementById('hudRight').value = '2';
            document.getElementById('hudScale').value = '100';
            document.getElementById('notifBottom').value = '11';
            document.getElementById('notifRight').value = '2';
            document.getElementById('achievBottom').value = '15.5';
            document.getElementById('achievRight').value = '1';
            
            updateHudPositions();
        }

        function applyPresetLayout(preset) {
            if (preset === 'compact') {
                document.getElementById('ericBottom').value = '1.5';
                document.getElementById('ericRight').value = '1.5';
                document.getElementById('ericSize').value = '70';
                document.getElementById('hudBottom').value = '7';
                document.getElementById('hudRight').value = '1.5';
                document.getElementById('hudScale').value = '85';
                document.getElementById('notifBottom').value = '5.5';
                document.getElementById('notifRight').value = '1.5';
                document.getElementById('achievBottom').value = '9';
                document.getElementById('achievRight').value = '0.5';
            } else if (preset === 'spacious') {
                document.getElementById('ericBottom').value = '3';
                document.getElementById('ericRight').value = '3';
                document.getElementById('ericSize').value = '100';
                document.getElementById('hudBottom').value = '13';
                document.getElementById('hudRight').value = '3';
                document.getElementById('hudScale').value = '115';
                document.getElementById('notifBottom').value = '10';
                document.getElementById('notifRight').value = '3';
                document.getElementById('achievBottom').value = '16';
                document.getElementById('achievRight').value = '2';
            }
            updateHudPositions();
        }

        function loadHudPositions() {
            const savedPositions = localStorage.getItem('hud-positions');
            if (savedPositions) {
                const positions = JSON.parse(savedPositions);
                document.getElementById('ericBottom').value = positions.ericBottom || '3.5';
                document.getElementById('ericRight').value = positions.ericRight || '2';
                document.getElementById('ericSize').value = positions.ericSize || '88';
                document.getElementById('hudBottom').value = positions.hudBottom || '5';
                document.getElementById('hudRight').value = positions.hudRight || '2';
                document.getElementById('hudScale').value = positions.hudScale || '100';
                document.getElementById('notifBottom').value = positions.notifBottom || '11';
                document.getElementById('notifRight').value = positions.notifRight || '2';
                document.getElementById('achievBottom').value = positions.achievBottom || '15.5';
                document.getElementById('achievRight').value = positions.achievRight || '1';
                updateHudPositions();
            }
        }

        // Variables globales pour la pr√©visualisation
        let hudPreviewActive = false;
        let previewIntervals = [];

        function toggleHudPreview() {
            const previewButton = document.getElementById('previewToggle');
            
            if (!hudPreviewActive) {
                // Activer la pr√©visualisation
                hudPreviewActive = true;
                previewButton.innerHTML = '<i class="fas fa-eye-slash mr-1"></i>Masquer';
                previewButton.style.background = 'rgba(239, 68, 68, 0.2)';
                previewButton.style.borderColor = 'rgba(239, 68, 68, 0.4)';
                previewButton.style.color = '#ef4444';
                
                startHudPreview();
            } else {
                // D√©sactiver la pr√©visualisation
                hudPreviewActive = false;
                previewButton.innerHTML = '<i class="fas fa-eye mr-1"></i>Pr√©visualiser';
                previewButton.style.background = 'rgba(6,182,212,0.1)';
                previewButton.style.borderColor = 'rgba(6,182,212,0.2)';
                previewButton.style.color = 'var(--primary)';
                
                stopHudPreview();
            }
        }

        function startHudPreview() {
            // Forcer l'affichage temporaire de tous les √©l√©ments gaming
            const gameHUD = document.getElementById('gameHUD');
            const tamagotchi = document.getElementById('tamagotchi');
            const gameNotification = document.getElementById('gameNotification');
            const achievementToast = document.getElementById('achievementToast');
            const overlay = document.getElementById('colorPickerOverlay');
            
            // Sauvegarder l'√©tat actuel
            const currentGamingMode = gamingMode;
            const originalHudDisplay = gameHUD.style.display;
            const originalTamaDisplay = tamagotchi.style.display;
            
            // Afficher temporairement tous les √©l√©ments
            gameHUD.classList.add('show');
            tamagotchi.classList.add('show');
            
            // Ajouter des √©tiquettes temporaires
            const hudLabel = document.createElement('div');
            hudLabel.id = 'temp-hud-label';
            hudLabel.innerHTML = 'üìä Barre XP/HUD';
            hudLabel.style.cssText = `
                position: fixed;
                bottom: calc(${document.getElementById('hudBottom').value}rem + 60px);
                right: ${document.getElementById('hudRight').value}rem;
                background: rgba(6,182,212,0.9);
                color: white;
                padding: 4px 8px;
                border-radius: 4px;
                font-size: 12px;
                font-weight: bold;
                z-index: 10001;
                pointer-events: none;
                box-shadow: 0 2px 8px rgba(0,0,0,0.3);
            `;
            document.body.appendChild(hudLabel);
            
            const ericLabel = document.createElement('div');
            ericLabel.id = 'temp-eric-label';
            ericLabel.innerHTML = 'üê± √âric (Chat)';
            ericLabel.style.cssText = `
                position: fixed;
                bottom: calc(${document.getElementById('ericBottom').value}rem + ${parseInt(document.getElementById('ericSize').value) + 10}px);
                right: ${document.getElementById('ericRight').value}rem;
                background: rgba(139,92,246,0.9);
                color: white;
                padding: 4px 8px;
                border-radius: 4px;
                font-size: 12px;
                font-weight: bold;
                z-index: 10001;
                pointer-events: none;
                box-shadow: 0 2px 8px rgba(0,0,0,0.3);
            `;
            document.body.appendChild(ericLabel);
            
            // Afficher une notification de demo
            document.getElementById('notificationText').textContent = 'üì± Zone Notifications';
            gameNotification.classList.add('show');
            
            // Afficher un achievement de demo
            document.getElementById('achievementTitle').textContent = 'üèÜ Zone Achievements';
            document.getElementById('achievementDesc').textContent = 'Succ√®s et r√©compenses apparaissent ici';
            achievementToast.classList.add('show');
            
            // Ajouter les classes CSS pour marquer la pr√©visualisation
            document.body.classList.add('hud-preview-mode');
            document.body.classList.add('hud-preview-active');
            overlay.classList.add('hud-preview-mode');
            
            // Animation subtile pour attirer l'attention
            let pulseCount = 0;
            const pulseInterval = setInterval(() => {
                if (!hudPreviewActive || pulseCount >= 6) {
                    clearInterval(pulseInterval);
                    return;
                }
                
                const elements = [gameHUD, tamagotchi, gameNotification, achievementToast];
                elements.forEach(el => {
                    if (el) {
                        el.style.transform += ' scale(' + (pulseCount % 2 === 0 ? '1.05' : '1') + ')';
                        setTimeout(() => {
                            if (el.style.transform) {
                                el.style.transform = el.style.transform.replace(/scale\([^)]*\)/g, '');
                            }
                        }, 200);
                    }
                });
                pulseCount++;
            }, 400);
            
            previewIntervals.push(pulseInterval);
        }

        function stopHudPreview() {
            // Nettoyer les intervalles
            previewIntervals.forEach(interval => clearInterval(interval));
            previewIntervals = [];
            
            // Retirer les classes de pr√©visualisation
            document.body.classList.remove('hud-preview-mode');
            document.body.classList.remove('hud-preview-active');
            const overlay = document.getElementById('colorPickerOverlay');
            overlay.classList.remove('hud-preview-mode');
            
            // Masquer les √©l√©ments si le mode gaming n'est pas actif
            if (!gamingMode) {
                const gameHUD = document.getElementById('gameHUD');
                const tamagotchi = document.getElementById('tamagotchi');
                const gameNotification = document.getElementById('gameNotification');
                const achievementToast = document.getElementById('achievementToast');
                
                gameHUD.classList.remove('show');
                tamagotchi.classList.remove('show');
                gameNotification.classList.remove('show');
                achievementToast.classList.remove('show');
            }
            
            // Supprimer les √©tiquettes temporaires
            const hudLabel = document.getElementById('temp-hud-label');
            const ericLabel = document.getElementById('temp-eric-label');
            if (hudLabel) hudLabel.remove();
            if (ericLabel) ericLabel.remove();
            
            // Nettoyer les transformations
            document.querySelectorAll('.game-hud, .tamagotchi, .game-notification, .achievement-toast').forEach(el => {
                if (el.style.transform) {
                    el.style.transform = el.style.transform.replace(/scale\([^)]*\)/g, '');
                }
            });
        }

        function hexToRgb(hex) {
            const result = /^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(hex);
            return result ?
                `${parseInt(result[1], 16)}, ${parseInt(result[2], 16)}, ${parseInt(result[3], 16)}` :
                '6, 182, 212';
        }

        // Particle Functions
        function applyParticlePreset(presetName) {
            const presets = {
                minimal: {type: 'circle', movement: 'float', intensity: 20, speed: 'slow', size: 'micro', opacity: 'subtle'},
                classic: {type: 'circle', movement: 'float', intensity: 50, speed: 'normal', size: 'small', opacity: 'subtle'},
                dynamic: {type: 'star', movement: 'spiral', intensity: 100, speed: 'fast', size: 'medium', opacity: 'visible'},
                cosmic: {type: 'triangle', movement: 'orbital', intensity: 150, speed: 'ultra', size: 'large', opacity: 'intense'}
            };

            const preset = presets[presetName];
            if (preset && particleSystem) {
                Object.entries(preset).forEach(([key, value]) => {
                    const element = document.getElementById(`particle${key.charAt(0).toUpperCase() + key.slice(1)}`);
                    if (element) {
                        element.value = value;
                        if (key === 'intensity') {
                            document.getElementById('intensityValue').textContent = value;
                        }
                    }
                });

                document.querySelectorAll('.preset-btn').forEach(btn => {
                    btn.classList.remove('active');
                });
                document.querySelector(`[onclick="applyParticlePreset('${presetName}')"]`).classList.add('active');

                particleSystem.updateSettings(preset);
            }
        }

        function updateParticles() {
            if (!particleSystem) return;

            const settings = {
                type: document.getElementById('particleType').value,
                movement: document.getElementById('particleMovement').value,
                intensity: parseInt(document.getElementById('particleIntensity').value),
                speed: document.getElementById('particleSpeed').value,
                size: document.getElementById('particleSize').value,
                opacity: document.getElementById('particleOpacity').value
            };

            document.getElementById('intensityValue').textContent = settings.intensity;
            particleSystem.updateSettings(settings);
            
            // Particle customization achievement
            if (gamingMode) {
                unlockAchievement('particle_artist');
            }
        }

        function resetParticles() {
            applyParticlePreset('classic');
        }

        function saveParticleSettings() {
            const settings = particleSystem.settings;
            localStorage.setItem('particle-settings', JSON.stringify(settings));
            
            const btn = event.target;
            const originalText = btn.innerHTML;
            btn.innerHTML = '<i class="fas fa-check mr-2"></i>Sauvegard√©';
            setTimeout(() => {
                btn.innerHTML = originalText;
            }, 2000);
        }

        // Gaming Functions
        function unlockGamingMode() {
            if (gamingUnlocked) return;
            
            gamingUnlocked = true;
            localStorage.setItem('gamingUnlocked', 'true');
            
            const gameToggle = document.getElementById('gameToggle');
            gameToggle.classList.add('unlocked');
            
            unlockAchievement('gaming_unlocked', true); // Force show even if gaming not enabled yet
            
            // Auto-enable gaming mode
            gamingMode = true;
            localStorage.setItem('gamingMode', 'true');
            updateGamingMode();
        }

        function toggleGaming() {
            if (!gamingUnlocked) return;
            
            gamingMode = !gamingMode;
            localStorage.setItem('gamingMode', gamingMode);
            updateGamingMode();
        }

        function updateGamingMode() {
            const hud = document.getElementById('gameHUD');
            const tama = document.getElementById('tamagotchi');
            const toggle = document.getElementById('gameToggle');
            const minigamesTrigger = document.getElementById('minigamesTrigger');

            if (gamingMode && gamingUnlocked) {
                hud.classList.add('show');
                tama.classList.add('show');
                if (minigamesTrigger) minigamesTrigger.classList.add('active');
                toggle.innerHTML = 'üéÆ';
                toggle.style.background = 'rgba(139, 92, 246, 0.2)';
                toggle.title = 'Mode Gaming: Activ√©';
                toggle.setAttribute('data-text', 'Gaming ON');
            } else if (gamingUnlocked) {
                hud.classList.remove('show');
                tama.classList.remove('show');
                if (minigamesTrigger) minigamesTrigger.classList.remove('active');
                toggle.innerHTML = 'üéÆ';
                toggle.style.background = 'rgba(148, 163, 184, 0.1)';
                toggle.title = 'Mode Gaming: D√©sactiv√©';
                toggle.setAttribute('data-text', 'Gaming OFF');
            }
        }

        function triggerAction(action) {
            if (!gamingMode) return;

            const xpGain = {
                'skill-hover': 2,
                'contact-email': 10,
                'contact-github': 15,
                'download-pdf': 25,
                'video-theater': 8,
                'customization': 5,
                'portrait-click': 3
            }[action] || 1;

            gameStats.xp += xpGain;
            gameStats.score += xpGain * 10;

            // Level up check
            if (gameStats.xp >= gameStats.level * 100) {
                const newLevel = gameStats.level + 1;
                gameStats.level = newLevel;
                gameStats.xp = 0;
                showAchievement('Level Up!', `Niveau ${newLevel} atteint!`);
                
                // Level-based achievements
                if (newLevel === 2) {
                    unlockAchievement('level_up_first');
                } else if (newLevel === 5) {
                    unlockAchievement('high_level');
                }
            }

            // Score-based achievements
            if (gameStats.score >= 1000 && !hasAchievement('score_hunter')) {
                unlockAchievement('score_hunter');
            }

            updateGameDisplay();
            saveGameStats();

            // Action-specific achievements
            if (action === 'contact-email') {
                unlockAchievement('first_contact');
            } else if (action === 'contact-github') {
                unlockAchievement('github_explorer');
            } else if (action === 'download-pdf') {
                unlockAchievement('pdf_downloader');
            } else if (action === 'video-theater') {
                unlockAchievement('video_watcher');
                checkPortfolioCompletionist();
            } else if (action === 'customization') {
                unlockAchievement('theme_changer');
            } else if (action === 'skill-hover') {
                checkSkillExplorer();
            }

            showGameNotification(`+${xpGain} XP`);
        }

        function updateGameDisplay() {
            if (!gamingMode) return;
            
            document.getElementById('scoreDisplay').textContent = gameStats.score.toLocaleString();
            document.getElementById('xpDisplay').textContent = gameStats.xp;
            document.getElementById('levelDisplay').textContent = gameStats.level;
            document.getElementById('totalScore').textContent = gameStats.score.toLocaleString();
            document.getElementById('totalAchievements').textContent = gameStats.achievements.length;
            document.getElementById('tamaLevel').textContent = gameStats.tamaLevel;
            
            // Calculate and display max achievements
            const maxAchievements = calculateMaxAchievements();
            document.getElementById('maxAchievements').textContent = maxAchievements;
            
            // Update achievements list
            updateAchievementsList();
            
            const xpPercent = (gameStats.xp / (gameStats.level * 100)) * 100;
            document.getElementById('xpProgress').style.width = xpPercent + '%';
        }

        // Centralized Achievement System
        const ACHIEVEMENTS = {
            // Core Gaming
            gaming_unlocked: {
                id: 'gaming_unlocked',
                title: 'Mode Gaming D√©bloqu√©!',
                description: 'Vous avez d√©couvert le secret ! üéÆ',
                icon: 'üéÆ'
            },
            
            // Contact & Social
            first_contact: {
                id: 'first_contact',
                title: 'Premier Contact',
                description: 'Vous avez cliqu√© sur mon email ! üìß',
                icon: 'üìß'
            },
            github_explorer: {
                id: 'github_explorer',
                title: 'Explorateur GitHub',
                description: 'Vous avez visit√© mon GitHub ! üêô',
                icon: 'üêô'
            },
            pdf_downloader: {
                id: 'pdf_downloader',
                title: 'Collectionneur CV',
                description: 'Vous avez t√©l√©charg√© mon CV ! üìÑ',
                icon: 'üìÑ'
            },
            
            // Portrait & Reading
            portrait_all_read: {
                id: 'portrait_all_read',
                title: 'Lecteur Assidu',
                description: 'Vous avez lu toutes les phrases du portrait ! üìñ',
                icon: 'üìñ'
            },
            portrait_addict: {
                id: 'portrait_addict',
                title: 'Accro aux Dialogues',
                description: 'Vous avez cliqu√© 10 fois sur le portrait ! üí¨',
                icon: 'üí¨'
            },
            
            // Language Switching
            jen_perds_mon_latin: {
                id: 'jen_perds_mon_latin',
                title: 'J\'en perds mon latin !',
                description: 'Vous changez de langue trop vite ! ü§Ø',
                icon: 'ü§Ø'
            },
            faceclicker: {
                id: 'faceclicker',
                title: 'Faceclicker',
                description: 'Vous aimez jouer avec les langues ! üòÑ',
                icon: 'üòÑ'
            },
            philosophe: {
                id: 'philosophe',
                title: 'Philosophe',
                description: 'La r√©flexion profonde vous habite ! üìñ',
                icon: 'üìñ'
            },
            sagesse: {
                id: 'sagesse',
                title: 'Sagesse',
                description: 'L\'exp√©rience forge la sagesse ! ü§îüí´',
                icon: 'ü§îüí´'
            },
            
            // Skills & Learning
            skill_explorer: {
                id: 'skill_explorer',
                title: 'Explorateur de Skills',
                description: 'Vous avez explor√© 10 comp√©tences ! üîç',
                icon: 'üîç'
            },
            skill_master: {
                id: 'skill_master',
                title: 'Ma√Ætre des Comp√©tences',
                description: 'Vous avez explor√© toutes les comp√©tences ! üèÜ',
                icon: 'üèÜ'
            },
            
            // Portfolio & Videos
            video_watcher: {
                id: 'video_watcher',
                title: 'Cin√©phile Tech',
                description: 'Vous avez regard√© une vid√©o portfolio ! üé¨',
                icon: 'üé¨'
            },
            portfolio_completionist: {
                id: 'portfolio_completionist',
                title: 'Compl√©tionniste',
                description: 'Vous avez regard√© toutes les vid√©os ! üéØ',
                icon: 'üéØ'
            },
            
            // Customization
            theme_changer: {
                id: 'theme_changer',
                title: 'D√©corateur',
                description: 'Vous avez chang√© le th√®me ! üé®',
                icon: 'üé®'
            },
            particle_artist: {
                id: 'particle_artist',
                title: 'Artiste Particule',
                description: 'Vous avez personnalis√© les particules ! ‚ú®',
                icon: '‚ú®'
            },
            
            // Gaming & Progression
            level_up_first: {
                id: 'level_up_first',
                title: 'Premier Level Up!',
                description: 'Vous avez atteint le niveau 2 ! ‚¨ÜÔ∏è',
                icon: '‚¨ÜÔ∏è'
            },
            high_level: {
                id: 'high_level',
                title: 'Haut Niveau',
                description: 'Vous avez atteint le niveau 5 ! üöÄ',
                icon: 'ÔøΩ'
            },
            score_hunter: {
                id: 'score_hunter',
                title: 'Chasseur de Score',
                description: 'Vous avez atteint 1000 points ! üíØ',
                icon: 'üíØ'
            },
            
            // Tamagotchi
            tama_feeder: {
                id: 'tama_feeder',
                title: 'Ami d\'√âric',
                description: 'Vous avez nourri √âric ! üê±',
                icon: 'üê±'
            },
            tama_master: {
                id: 'tama_master',
                title: 'Ma√Ætre Tamagotchi',
                description: '√âric a atteint le niveau maximum ! üëë',
                icon: 'üëë'
            }
        };

        // Centralized Achievement Functions
        function unlockAchievement(achievementId, forceShow = false) {
            if (!gamingMode && !forceShow) return false;
            
            const achievement = ACHIEVEMENTS[achievementId];
            if (!achievement) {
                console.warn('Achievement not found:', achievementId);
                return false;
            }
            
            if (gameStats.achievements.includes(achievementId)) {
                return false; // Already unlocked
            }
            
            console.log('Unlocking achievement:', achievementId);
            gameStats.achievements.push(achievementId);
            showAchievement(achievement.title, achievement.description);
            saveGameStats();
            return true;
        }

        function hasAchievement(achievementId) {
            return gameStats.achievements.includes(achievementId);
        }

        // Achievement checker functions
        function checkSkillExplorer() {
            if (!gameStats.skillsExplored) {
                gameStats.skillsExplored = new Set();
            }
            
            if (gameStats.skillsExplored.size >= 10) {
                unlockAchievement('skill_explorer');
            }
            
            // Count total skills
            const totalSkills = Object.values(skillsData).reduce((total, category) => {
                return total + Object.keys(category).length;
            }, 0);
            
            if (gameStats.skillsExplored.size >= totalSkills) {
                unlockAchievement('skill_master');
            }
        }

        function checkPortfolioCompletionist() {
            if (!gameStats.videosWatched) {
                gameStats.videosWatched = new Set();
            }
            
            if (gameStats.videosWatched.size >= portfolioVideos.length) {
                unlockAchievement('portfolio_completionist');
            }
        }

        function trackSkillHover(skillName) {
            if (!gameStats.skillsExplored) {
                gameStats.skillsExplored = new Set();
            }
            
            gameStats.skillsExplored.add(skillName);
            saveGameStats();
        }

        function trackVideoWatch(videoId) {
            if (!gameStats.videosWatched) {
                gameStats.videosWatched = new Set();
            }
            
            gameStats.videosWatched.add(videoId);
            saveGameStats();
        }

        function calculateMaxAchievements() {
            return Object.keys(ACHIEVEMENTS).length;
        }

        function getAchievementDisplayName(achievementKey) {
            const achievement = ACHIEVEMENTS[achievementKey];
            if (achievement) {
                return `${achievement.icon} ${achievement.title}`;
            }
            return `üèÜ ${achievementKey}`;
        }

        function updateAchievementsList() {
            const achievementsList = document.getElementById('achievementsList');
            
            if (gameStats.achievements.length === 0) {
                achievementsList.innerHTML = '<p class="text-xs text-gray-400 italic">Aucun succ√®s d√©bloqu√© pour le moment</p>';
                return;
            }
            
            const achievementsHtml = gameStats.achievements.map(achievement => {
                const displayName = getAchievementDisplayName(achievement);
                return `<div class="flex items-center gap-2 p-2 bg-gray-700 bg-opacity-50 rounded text-xs">
                    <span class="text-yellow-400">${displayName}</span>
                </div>`;
            }).join('');
            
            achievementsList.innerHTML = achievementsHtml;
        }

        function showAchievement(title, description) {
            const toast = document.getElementById('achievementToast');
            document.getElementById('achievementTitle').textContent = title;
            document.getElementById('achievementDesc').textContent = description;
            
            toast.classList.add('show');
            setTimeout(() => toast.classList.remove('show'), 5000);
            
            // Update achievements display
            updateGameDisplay();
        }

        function showGameNotification(text) {
            const notification = document.getElementById('gameNotification');
            document.getElementById('notificationText').textContent = text;
            
            notification.classList.add('show');
            setTimeout(() => notification.classList.remove('show'), 3000);
        }

        function feedTamagotchi() {
            if (!gamingMode) return;
            
            gameStats.tamaLevel = Math.min(gameStats.tamaLevel + 1, 10);
            showGameNotification(`Eric nourri ! Niveau ${gameStats.tamaLevel}`);
            
            // Tamagotchi achievements
            unlockAchievement('tama_feeder');
            if (gameStats.tamaLevel >= 10) {
                unlockAchievement('tama_master');
            }
            
            updateGameDisplay();
            updateTamaIcon();
            saveGameStats();
        }

        function toggleGamingFromEric(event) {
            event.preventDefault(); // Emp√™che le menu contextuel
            
            if (!gamingMode) return;
            
            // D√©sactiver le mode gaming
            gamingMode = false;
            localStorage.setItem('gamingMode', gamingMode);
            
            // Masquer √âric et afficher le bouton manette
            document.getElementById('tamagotchi').style.display = 'none';
            document.getElementById('gamingController').style.display = 'flex';
            
            // Masquer tous les √©l√©ments gaming
            document.getElementById('gameHUD').classList.remove('show');
            document.getElementById('achievementToast').classList.remove('show');
            document.getElementById('gameNotification').classList.remove('show');
            
            showGameNotification('Mode Gaming d√©sactiv√©');
        }

        function reactivateGaming() {
            // R√©activer le mode gaming
            gamingMode = true;
            localStorage.setItem('gamingMode', gamingMode);
            
            // Masquer le bouton manette et afficher √âric
            document.getElementById('gamingController').style.display = 'none';
            document.getElementById('tamagotchi').style.display = 'flex';
            
            // R√©afficher les √©l√©ments gaming
            updateGamingMode();
            
            showGameNotification('Mode Gaming r√©activ√© ! √âric est de retour üê±');
        }

        // ============================================
        // RESET LOCALSTORAGE (LONG PRESS 10s)
        // ============================================
        let resetTimer = null;
        let resetStartTime = 0;
        let resetAnimationFrame = null;
        
        function startResetTimer(event) {
            // Prevent triggering click on long press
            event.preventDefault();
            
            resetStartTime = Date.now();
            const progress = document.getElementById('resetProgress');
            progress.classList.add('active');
            progress.style.setProperty('--progress', '0%');
            
            // Animation loop
            function updateProgress() {
                const elapsed = Date.now() - resetStartTime;
                const percent = Math.min((elapsed / 10000) * 100, 100);
                progress.style.setProperty('--progress', percent + '%');
                
                if (elapsed >= 10000) {
                    // Reset completed!
                    resetLocalStorage();
                } else {
                    resetAnimationFrame = requestAnimationFrame(updateProgress);
                }
            }
            
            resetAnimationFrame = requestAnimationFrame(updateProgress);
        }
        
        function cancelResetTimer() {
            if (resetAnimationFrame) {
                cancelAnimationFrame(resetAnimationFrame);
                resetAnimationFrame = null;
            }
            
            const progress = document.getElementById('resetProgress');
            progress.classList.remove('active');
            progress.style.setProperty('--progress', '0%');
            resetStartTime = 0;
        }
        
        function resetLocalStorage() {
            // Cancel animation
            if (resetAnimationFrame) {
                cancelAnimationFrame(resetAnimationFrame);
                resetAnimationFrame = null;
            }
            
            // Show complete state
            const progress = document.getElementById('resetProgress');
            progress.classList.remove('active');
            progress.classList.add('complete');
            
            // Vibration feedback if available
            if (navigator.vibrate) {
                navigator.vibrate([100, 50, 100, 50, 100]);
            }
            
            // Clear all localStorage
            localStorage.clear();
            
            // Show notification
            const message = currentLang === 'fr' 
                ? 'üîÑ localStorage r√©initialis√© !\\n\\nToutes les donn√©es ont √©t√© effac√©es.\\nLa page va se recharger...'
                : 'üîÑ localStorage reset!\\n\\nAll data has been cleared.\\nPage will reload...';
            
            alert(message);
            
            // Reload page after 1 second
            setTimeout(() => {
                location.reload();
            }, 1000);
        }
        
        function triggerPortraitDialogue() {
            const dialogue = document.getElementById('portraitDialogue');
            const profileImg = document.getElementById('profileImage');
            const randomMessage = getNextPortraitMessage(currentLang);
            
            portraitClicks++;
            localStorage.setItem('portraitClicks', portraitClicks.toString());
            
            // Portrait click achievements
            if (portraitClicks === 10) {
                unlockAchievement('portrait_addict');
            }
            
            // Stop previous portrait typewriter
            if (typewriterInstances.has('portrait')) {
                typewriterInstances.get('portrait').stop();
                typewriterInstances.delete('portrait');
            }
            
            // Gestion du timer pour la bulle portrait
            if (window.portraitDialogueTimeout) {
                clearTimeout(window.portraitDialogueTimeout);
            }

            document.getElementById('portraitText').textContent = '';
            dialogue.className = 'portrait-dialogue';
            dialogue.classList.add('show');

            // Calculate intelligent positioning
            positionPortraitDialogue(dialogue, profileImg);

            const typewriter = new TypewriterEffect(document.getElementById('portraitText'), randomMessage, {
                speed: 30,
                dialogue: dialogue // Pass dialogue reference for position adjustment
            });
            typewriterInstances.set('portrait', typewriter);
            typewriter.type();

            // Unlock gaming mode after 3 clicks
            if (portraitClicks >= 3 && !gamingUnlocked) {
                setTimeout(() => {
                    unlockGamingMode();
                }, 2000);
            }

            // Fade starts at 8s, remove at 10s
            window.portraitDialogueTimeout = setTimeout(() => {
                dialogue.classList.add('fade');
            }, 8000);
            setTimeout(() => {
                dialogue.classList.remove('show');
                dialogue.classList.remove('fade');
                window.portraitDialogueTimeout = null;
            }, 10000);

            if (gamingMode) {
                triggerAction('portrait-click');
            }
        }

        function positionPortraitDialogue(dialogue, profileImg) {
            const imgRect = profileImg.getBoundingClientRect();
            const viewportWidth = window.innerWidth;
            const viewportHeight = window.innerHeight;
            const dialogueWidth = 280; // max-width from CSS
            const dialogueHeight = 100; // estimated height for calculation
            const margin = 15; // margin from viewport edges
            const offset = 15; // distance from image
            
            let top, left, arrowClass, arrowPosition;
            
            // Calculate image center for arrow positioning
            const imgCenterX = imgRect.left + (imgRect.width / 2);
            const imgCenterY = imgRect.top + (imgRect.height / 2);
            
            // Preferred position: above the image, centered
            const centerLeft = imgRect.left + (imgRect.width / 2) - (dialogueWidth / 2);
            const aboveTop = imgRect.top - dialogueHeight - offset;
            
            // Check if we can position above
            if (aboveTop >= margin && 
                centerLeft >= margin && 
                centerLeft + dialogueWidth <= viewportWidth - margin) {
                // Position above, centered on image
                top = aboveTop;
                left = centerLeft;
                arrowClass = 'arrow-bottom';
                arrowPosition = imgCenterX - left; // Arrow position relative to dialogue left edge
            } else if (imgRect.bottom + dialogueHeight + offset <= viewportHeight - margin) {
                // Position below, centered on image
                top = imgRect.bottom + offset;
                left = Math.max(margin, Math.min(centerLeft, viewportWidth - dialogueWidth - margin));
                arrowClass = 'arrow-top';
                arrowPosition = imgCenterX - left; // Arrow position relative to dialogue left edge
            } else if (imgRect.left - dialogueWidth - offset >= margin) {
                // Position to the left
                top = Math.max(margin, imgRect.top + (imgRect.height / 2) - (dialogueHeight / 2));
                left = imgRect.left - dialogueWidth - offset;
                arrowClass = 'arrow-right';
                arrowPosition = imgCenterY - top; // Arrow position relative to dialogue top edge
            } else if (imgRect.right + dialogueWidth + offset <= viewportWidth - margin) {
                // Position to the right
                top = Math.max(margin, imgRect.top + (imgRect.height / 2) - (dialogueHeight / 2));
                left = imgRect.right + offset;
                arrowClass = 'arrow-left';
                arrowPosition = imgCenterY - top; // Arrow position relative to dialogue top edge
            } else {
                // Emergency fallback: above image but adjust horizontally to fit
                top = Math.max(margin, imgRect.top - dialogueHeight - offset);
                if (centerLeft < margin) {
                    left = margin;
                } else if (centerLeft + dialogueWidth > viewportWidth - margin) {
                    left = viewportWidth - dialogueWidth - margin;
                } else {
                    left = centerLeft;
                }
                arrowClass = 'arrow-bottom';
                arrowPosition = imgCenterX - left; // Arrow position relative to dialogue left edge
            }
            
            // Store initial positioning for dynamic growth
            dialogue.dataset.initialTop = Math.max(margin, top);
            dialogue.dataset.initialLeft = Math.max(margin, left);
            dialogue.dataset.arrowClass = arrowClass;
            dialogue.dataset.arrowPosition = arrowPosition;
            
            // Apply initial positioning
            dialogue.style.top = dialogue.dataset.initialTop + 'px';
            dialogue.style.left = dialogue.dataset.initialLeft + 'px';
            
            // Set arrow position using CSS custom property
            dialogue.style.setProperty('--arrow-offset', arrowPosition + 'px');
            
            dialogue.classList.add(arrowClass);
        }

        function resetProfile() {
            // Reset game stats
            gameStats = {
                score: 0, 
                xp: 0, 
                level: 1, 
                achievements: [], 
                tamaLevel: 1,
                skillsExplored: new Set(),
                videosWatched: new Set()
            };
            
            // Reset portrait clicks counter
            portraitClicks = 0;
            
            // Reset language switch counters
            rapidSwitchCounter = 0;
            rapidSwitchMode = false;
            lastSwitchTime = 0;
            
            // Reset portrait message cycling
            window.portraitMessageCycle = {
                fr: { available: [], seen: new Set() },
                en: { available: [], seen: new Set() }
            };
            
            // Reset visit tracking
            localStorage.removeItem('cv-visited');
            
            // Clear all gaming-related localStorage
            localStorage.removeItem('gameStats');
            localStorage.removeItem('portraitClicks');
            localStorage.removeItem('gamingUnlocked');
            localStorage.removeItem('gamingMode');
            
            // Reset gaming mode state
            gamingUnlocked = false;
            gamingMode = false;
            
            // Update displays
            updateGameDisplay();
            updateGamingMode();
            
            // Show confirmation
            showGameNotification('Profil r√©initialis√© !');
            
            // Update game toggle button
            const gameToggle = document.getElementById('gameToggle');
            gameToggle.classList.remove('unlocked');
            gameToggle.innerHTML = 'üîí';
            gameToggle.style.background = 'rgba(148, 163, 184, 0.1)';
            gameToggle.title = 'Mode Gaming: Verrouill√©';
            gameToggle.setAttribute('data-text', 'Locked');
        }

        function saveGameStats() {
            const saveData = {
                ...gameStats,
                skillsExplored: Array.from(gameStats.skillsExplored || []),
                videosWatched: Array.from(gameStats.videosWatched || [])
            };
            localStorage.setItem('gameStats', JSON.stringify(saveData));
        }

        // Portrait message cycling functions
        function shuffleArray(array) {
            const shuffled = [...array];
            for (let i = shuffled.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [shuffled[i], shuffled[j]] = [shuffled[j], shuffled[i]];
            }
            return shuffled;
        }

        function getNextPortraitMessage(lang) {
            const cycle = window.portraitMessageCycle[lang];
            const allMessages = portraitMessages[lang];
            
            // If no available messages, refill with shuffled array
            if (cycle.available.length === 0) {
                cycle.available = shuffleArray([...allMessages]);
                
                // Check if we've seen all messages for achievement
                if (cycle.seen.size === allMessages.length && gamingMode) {
                    unlockAchievement('portrait_all_read');
                }
            }
            
            // Get next message and mark as seen
            const message = cycle.available.pop();
            cycle.seen.add(message);
            
            return message;
        }

        function showWelcomeMessage() {
            // Check if it's the first visit
            const hasVisited = localStorage.getItem('cv-visited');
            const isFirstVisit = !hasVisited;
            
            // Mark as visited
            localStorage.setItem('cv-visited', 'true');
            
            // Get appropriate welcome message
            const messageType = isFirstVisit ? 'first' : 'return';
            const messages = welcomeMessages[currentLang][messageType];
            const randomMessage = messages[Math.floor(Math.random() * messages.length)];
            
            // Show welcome dialogue after a short delay
            setTimeout(() => {
                const dialogue = document.getElementById('portraitDialogue');
                const profileImg = document.getElementById('profileImage');
                
                // Stop any existing portrait typewriter
                if (typewriterInstances.has('portrait')) {
                    typewriterInstances.get('portrait').stop();
                    typewriterInstances.delete('portrait');
                }
                
                // Clear any existing timeout
                if (window.portraitDialogueTimeout) {
                    clearTimeout(window.portraitDialogueTimeout);
                }

                document.getElementById('portraitText').textContent = '';
                dialogue.className = 'portrait-dialogue welcome-message';
                dialogue.classList.add('show');

                // Calculate intelligent positioning
                positionPortraitDialogue(dialogue, profileImg);

                const typewriter = new TypewriterEffect(document.getElementById('portraitText'), randomMessage, {
                    speed: 40,
                    dialogue: dialogue
                });
                typewriterInstances.set('portrait', typewriter);
                typewriter.type();

                // Welcome messages stay longer (12s before fade, 15s total)
                window.portraitDialogueTimeout = setTimeout(() => {
                    dialogue.classList.add('fade');
                }, 12000);
                setTimeout(() => {
                    dialogue.classList.remove('show');
                    dialogue.classList.remove('fade');
                    dialogue.classList.remove('welcome-message');
                    window.portraitDialogueTimeout = null;
                }, 15000);
            }, 1500); // 1.5s delay after page load
        }

        function handleLanguageSwitch(newLang) {
            const currentTime = Date.now();
            const timeDiff = currentTime - lastSwitchTime;
            
            console.log('handleLanguageSwitch called:', newLang, 'timeDiff:', timeDiff, 'rapidSwitchCounter:', rapidSwitchCounter);
            
            // Detect rapid switching (less than 3 seconds between switches)
            if (timeDiff < 3000 && lastSwitchTime > 0) {
                rapidSwitchMode = true;
                rapidSwitchCounter++;
                console.log('Rapid switch detected, counter now:', rapidSwitchCounter);
            } else if (timeDiff > 10000) {
                // Reset if more than 10 seconds elapsed
                rapidSwitchMode = false;
                rapidSwitchCounter = 0;
                console.log('Reset rapid switch counter');
            }
            
            lastSwitchTime = currentTime;
            
            let message = "";
            let achievementTitle = "";
            let achievementDesc = "";
            let achievementKey = "";
            let shouldShowMessage = true;
            
            if (rapidSwitchMode) {
                console.log('In rapid switch mode, counter:', rapidSwitchCounter);
                if (rapidSwitchCounter === 3) {
                    // Third rapid switch - confusion message REPLACES normal message
                    const confusionMsg = languageSwitchMessages.confusion[Math.floor(Math.random() * languageSwitchMessages.confusion.length)];
                    message = confusionMsg;
                    achievementTitle = "J'en perds mon latin !";
                    achievementDesc = "Vous changez de langue trop vite ! ü§Ø";
                    achievementKey = "jen_perds_mon_latin";
                } else if (rapidSwitchCounter === 5) {
                    // Fifth rapid switch - funny message REPLACES normal message
                    const funnyMsg = languageSwitchMessages.funny[Math.floor(Math.random() * languageSwitchMessages.funny.length)];
                    message = funnyMsg;
                    achievementTitle = "Faceclicker";
                    achievementDesc = "Vous aimez jouer avec les langues ! üòÑ";
                    achievementKey = "faceclicker";
                } else if (rapidSwitchCounter === 10) {
                    // Tenth rapid switch - philosophical message REPLACES normal message
                    message = languageSwitchMessages.philosophical[0];
                    achievementTitle = "Philosophe";
                    achievementDesc = "La r√©flexion profonde vous habite ! üìñ";
                    achievementKey = "philosophe";
                } else if (rapidSwitchCounter === 15) {
                    // Fifteenth rapid switch - wisdom message REPLACES normal message
                    message = languageSwitchMessages.wisdom[0];
                    achievementTitle = "Sagesse";
                    achievementDesc = "L'exp√©rience forge la sagesse ! ü§îüí´";
                    achievementKey = "sagesse";
                    // Reset counter after wisdom message
                    rapidSwitchCounter = 0;
                    rapidSwitchMode = false;
                } else {
                    // Regular rapid switch - show normal language message
                    if (newLang === 'fr') {
                        const messages = languageSwitchMessages.toFrench;
                        message = messages[Math.floor(Math.random() * messages.length)];
                    } else {
                        const messages = languageSwitchMessages.toEnglish;
                        message = messages[Math.floor(Math.random() * messages.length)];
                    }
                }
            } else {
                console.log('In normal switch mode');
                // Normal language switch message
                if (newLang === 'fr') {
                    const messages = languageSwitchMessages.toFrench;
                    message = messages[Math.floor(Math.random() * messages.length)];
                } else {
                    const messages = languageSwitchMessages.toEnglish;
                    message = messages[Math.floor(Math.random() * messages.length)];
                }
            }
            
            console.log('Final values - message:', message, 'achievementKey:', achievementKey, 'achievementTitle:', achievementTitle);
            
            // Show message first
            if (shouldShowMessage && message) {
                setTimeout(() => {
                    showLanguageMessage(message);
                }, 500);
            }
            
            // Handle achievement after showing message
            if (achievementKey && achievementTitle && gamingMode) {
                console.log('Checking achievement:', achievementKey, 'gamingMode:', gamingMode);
                console.log('Current achievements:', gameStats.achievements);
                unlockAchievement(achievementKey);
            }
        }

        function showLanguageMessage(message) {
            const dialogue = document.getElementById('portraitDialogue');
            const profileImg = document.getElementById('profileImage');
            
            console.log('showLanguageMessage called with message:', message);
            
            // Stop any existing portrait typewriter
            if (typewriterInstances.has('portrait')) {
                typewriterInstances.get('portrait').stop();
                typewriterInstances.delete('portrait');
            }
            
            // Clear any existing timeout (same as normal portrait dialogues)
            if (window.portraitDialogueTimeout) {
                clearTimeout(window.portraitDialogueTimeout);
            }

            document.getElementById('portraitText').textContent = '';
            dialogue.className = 'portrait-dialogue language-switch';
            dialogue.classList.add('show');

            // Calculate intelligent positioning
            positionPortraitDialogue(dialogue, profileImg);

            const typewriter = new TypewriterEffect(document.getElementById('portraitText'), message, {
                speed: 35,
                dialogue: dialogue
            });
            typewriterInstances.set('portrait', typewriter);
            typewriter.type();

            // Use same timing as normal portrait messages (8s before fade, 10s total)
            window.portraitDialogueTimeout = setTimeout(() => {
                dialogue.classList.add('fade');
            }, 8000);
            setTimeout(() => {
                dialogue.classList.remove('show');
                dialogue.classList.remove('fade');
                dialogue.classList.remove('language-switch');
                window.portraitDialogueTimeout = null;
            }, 10000);
        }

        // Mini Game Functions
        function startMiniGame() {
            document.getElementById('miniGameOverlay').classList.add('active');
            generateNewPuzzle();
        }

        function closeMiniGame(event) {
            if (event && event.target !== event.currentTarget && !event.target.classList.contains('close-theater')) return;
            document.getElementById('miniGameOverlay').classList.remove('active');
        }

        function generateNewPuzzle() {
            const currentPuzzles = puzzles[currentLang];
            currentPuzzle = Math.floor(Math.random() * currentPuzzles.length);
            const puzzle = currentPuzzles[currentPuzzle];
            
            document.getElementById('quizQuestion').textContent = puzzle.question;
            document.getElementById('puzzleResult').innerHTML = '';
            
            const optionsHtml = puzzle.options.map((option, index) => 
                `<button class="qcm-option" onclick="selectAnswer(${index})" data-index="${index}">
                    ${String.fromCharCode(65 + index)}. ${option}
                </button>`
            ).join('');
            
            document.getElementById('qcmOptions').innerHTML = optionsHtml;
        }

        function selectAnswer(selectedIndex) {
            const currentPuzzles = puzzles[currentLang];
            const puzzle = currentPuzzles[currentPuzzle];
            const resultDiv = document.getElementById('puzzleResult');
            
            if (selectedIndex === puzzle.correct) {
                resultDiv.innerHTML = `<div style="color: #10b981; font-weight: bold;">‚úì Correct!</div><p style="color: var(--text-secondary); font-size: 0.9rem; margin-top: 0.5rem;">${puzzle.explanation}</p>`;
                
                if (gamingMode) {
                    gameStats.xp += 50;
                    gameStats.score += 500;
                    updateGameDisplay();
                    showGameNotification('+50 XP Puzzle r√©solu!');
                }
            } else {
                resultDiv.innerHTML = `<div style="color: #ef4444; font-weight: bold;">‚úó Incorrect</div><p style="color: var(--text-secondary); font-size: 0.9rem; margin-top: 0.5rem;">${currentLang === 'fr' ? 'La bonne r√©ponse √©tait' : 'The correct answer was'}: ${String.fromCharCode(65 + puzzle.correct)}. ${puzzle.options[puzzle.correct]}</p>`;
            }
            
            // Highlight correct/incorrect answers
            document.querySelectorAll('.qcm-option').forEach((btn, index) => {
                if (index === puzzle.correct) {
                    btn.style.background = 'rgba(16, 185, 129, 0.2)';
                    btn.style.borderColor = '#10b981';
                } else if (index === selectedIndex && selectedIndex !== puzzle.correct) {
                    btn.style.background = 'rgba(239, 68, 68, 0.2)';
                    btn.style.borderColor = '#ef4444';
                }
                btn.disabled = true;
            });
        }

        // Contact Functions
        function openMail() {
            window.open('mailto:s.medjaher@gmail.com');
            if (gamingMode) triggerAction('contact-email');
        }

        function callPhone() {
            window.open('tel:+33780757576');
        }

        function openMaps() {
            if (navigator.geolocation) {
                navigator.geolocation.getCurrentPosition((position) => {
                    const {latitude, longitude} = position.coords;
                    const mapsUrl = `https://www.google.com/maps/dir/${latitude},${longitude}/69140+Rillieux-la-Pape,+France`;
                    window.open(mapsUrl, '_blank');
                }, () => {
                    window.open('https://www.google.com/maps/search/69140+Rillieux-la-Pape,+France', '_blank');
                });
            } else {
                window.open('https://www.google.com/maps/search/69140+Rillieux-la-Pape,+France', '_blank');
            }
        }

        function openGitHub() {
            window.open('https://github.com/Duperopope', '_blank');
            if (gamingMode) triggerAction('contact-github');
        }

        function scrollToPortfolio() {
            document.querySelector('.portfolio-section').scrollIntoView({behavior: 'smooth'});
        }

        // Initialize everything
        document.addEventListener('DOMContentLoaded', initializeCV);
    </script>
    
    <!-- Tamagotchi Enhanced - CSS Animations -->
    <link rel="stylesheet" href="tamagotchi-animations.css">
    
    <!-- Tamagotchi Mini-Games - CSS Interface -->
    <link rel="stylesheet" href="tamagotchi-minigames.css">
    
    <!-- Tamagotchi Enhanced - JavaScript Logic -->
    <script src="tamagotchi-enhanced.js"></script>
    
    <!-- Tamagotchi Mini-Games - JavaScript Logic -->
    <script src="tamagotchi-minigames.js"></script>
</body>
</html>